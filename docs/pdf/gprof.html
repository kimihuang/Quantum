<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This file documents the gprof profiler of the GNU system.

Copyright Â© 1988-2025 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, with no Front-Cover Texts, and with no
Back-Cover Texts.  A copy of the license is included in the
section entitled "GNU Free Documentation License".
 -->
<title>GNU gprof</title>

<meta name="description" content="GNU gprof">
<meta name="keywords" content="GNU gprof">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="#Top" rel="start" title="Top">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="#Introduction" rel="next" title="Introduction">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.center {text-align:center}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
pre.display-preformatted {font-family: inherit}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
ul.toc-numbered-mark {list-style: none}
-->
</style>


</head>

<body lang="en">






<div class="top-level-extent" id="Top">
<div class="nav-panel">
<p>
Next: <a href="#Introduction" accesskey="n" rel="next">Introduction to Profiling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h1 class="top" id="Profiling-a-Program_003a-Where-Does-It-Spend-Its-Time_003f"><span>Profiling a Program: Where Does It Spend Its Time?<a class="copiable-link" href="#Profiling-a-Program_003a-Where-Does-It-Spend-Its-Time_003f"> &para;</a></span></h1>

<p>This manual describes the <small class="sc">GNU</small> profiler, <code class="code">gprof</code>, and how you
can use it to determine which parts of a program are taking most of the
execution time.  We assume that you know how to write, compile, and
execute programs.  <small class="sc">GNU</small> <code class="code">gprof</code> was written by Jay Fenlason.
</p>
<p>This manual is for <code class="code">gprof</code>
(GNU Binutils)
version 2.45.
</p>
<p>This document is distributed under the terms of the GNU Free
Documentation License version 1.3.  A copy of the license is included
in the section entitled &ldquo;GNU Free Documentation License&rdquo;.
</p>

<div class="element-contents" id="SEC_Contents">
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="toc-numbered-mark">
  <li><a id="toc-Introduction-to-Profiling" href="#Introduction">1 Introduction to Profiling</a></li>
  <li><a id="toc-Compiling-a-Program-for-Profiling" href="#Compiling">2 Compiling a Program for Profiling</a></li>
  <li><a id="toc-Executing-the-Program" href="#Executing">3 Executing the Program</a></li>
  <li><a id="toc-gprof-Command-Summary" href="#Invoking">4 <code class="code">gprof</code> Command Summary</a>
  <ul class="toc-numbered-mark">
    <li><a id="toc-Output-Options-1" href="#Output-Options">4.1 Output Options</a></li>
    <li><a id="toc-Analysis-Options-1" href="#Analysis-Options">4.2 Analysis Options</a></li>
    <li><a id="toc-Miscellaneous-Options-1" href="#Miscellaneous-Options">4.3 Miscellaneous Options</a></li>
    <li><a id="toc-Deprecated-Options-1" href="#Deprecated-Options">4.4 Deprecated Options</a></li>
    <li><a id="toc-Symspecs-1" href="#Symspecs">4.5 Symspecs</a></li>
  </ul></li>
  <li><a id="toc-Interpreting-gprof_0027s-Output" href="#Output">5 Interpreting <code class="code">gprof</code>&rsquo;s Output</a>
  <ul class="toc-numbered-mark">
    <li><a id="toc-The-Flat-Profile" href="#Flat-Profile">5.1 The Flat Profile</a></li>
    <li><a id="toc-The-Call-Graph" href="#Call-Graph">5.2 The Call Graph</a>
    <ul class="toc-numbered-mark">
      <li><a id="toc-The-Primary-Line" href="#Primary">5.2.1 The Primary Line</a></li>
      <li><a id="toc-Lines-for-a-Function_0027s-Callers" href="#Callers">5.2.2 Lines for a Function&rsquo;s Callers</a></li>
      <li><a id="toc-Lines-for-a-Function_0027s-Subroutines" href="#Subroutines">5.2.3 Lines for a Function&rsquo;s Subroutines</a></li>
      <li><a id="toc-How-Mutually-Recursive-Functions-Are-Described" href="#Cycles">5.2.4 How Mutually Recursive Functions Are Described</a></li>
    </ul></li>
    <li><a id="toc-Line_002dby_002dline-Profiling" href="#Line_002dby_002dline">5.3 Line-by-line Profiling</a></li>
    <li><a id="toc-The-Annotated-Source-Listing" href="#Annotated-Source">5.4 The Annotated Source Listing</a></li>
  </ul></li>
  <li><a id="toc-Inaccuracy-of-gprof-Output" href="#Inaccuracy">6 Inaccuracy of <code class="code">gprof</code> Output</a>
  <ul class="toc-numbered-mark">
    <li><a id="toc-Statistical-Sampling-Error" href="#Sampling-Error">6.1 Statistical Sampling Error</a></li>
    <li><a id="toc-Estimating-children-Times" href="#Assumptions">6.2 Estimating <code class="code">children</code> Times</a></li>
  </ul></li>
  <li><a id="toc-Answers-to-Common-Questions" href="#How-do-I_003f">7 Answers to Common Questions</a></li>
  <li><a id="toc-Incompatibilities-with-Unix-gprof" href="#Incompatibilities">8 Incompatibilities with Unix <code class="code">gprof</code></a></li>
  <li><a id="toc-Details-of-Profiling" href="#Details">9 Details of Profiling</a>
  <ul class="toc-numbered-mark">
    <li><a id="toc-Implementation-of-Profiling" href="#Implementation">9.1 Implementation of Profiling</a></li>
    <li><a id="toc-Profiling-Data-File-Format" href="#File-Format">9.2 Profiling Data File Format</a>
    <ul class="toc-numbered-mark">
      <li><a id="toc-Histogram-Records" href="#Histogram-Records">9.2.1 Histogram Records</a></li>
      <li><a id="toc-Call_002dGraph-Records" href="#Call_002dGraph-Records">9.2.2 Call-Graph Records</a></li>
      <li><a id="toc-Basic_002dBlock-Execution-Count-Records" href="#Basic_002dBlock-Execution-Count-Records">9.2.3 Basic-Block Execution Count Records</a></li>
    </ul></li>
    <li><a id="toc-gprof_0027s-Internal-Operation" href="#Internals">9.3 <code class="code">gprof</code>&rsquo;s Internal Operation</a></li>
    <li><a id="toc-Debugging-gprof" href="#Debugging">9.4 Debugging <code class="code">gprof</code></a></li>
  </ul></li>
  <li><a id="toc-GNU-Free-Documentation-License-1" href="#GNU-Free-Documentation-License">Appendix A GNU Free Documentation License</a></li>
</ul>
</div>
</div>
<hr>
<div class="chapter-level-extent" id="Introduction">
<div class="nav-panel">
<p>
Next: <a href="#Compiling" accesskey="n" rel="next">Compiling a Program for Profiling</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Profiling a Program: Where Does It Spend Its Time?</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Introduction-to-Profiling"><span>1 Introduction to Profiling<a class="copiable-link" href="#Introduction-to-Profiling"> &para;</a></span></h2>


<p>Profiling allows you to learn where your program spent its time and which
functions called which other functions while it was executing.  This
information can show you which pieces of your program are slower than you
expected, and might be candidates for rewriting to make your program
execute faster.  It can also tell you which functions are being called more
or less often than you expected.  This may help you spot bugs that had
otherwise been unnoticed.
</p>
<p>Since the profiler uses information collected during the actual execution
of your program, it can be used on programs that are too large or too
complex to analyze by reading the source.  However, how your program is run
will affect the information that shows up in the profile data.  If you
don&rsquo;t use some feature of your program while it is being profiled, no
profile information will be generated for that feature.
</p>
<p>Profiling has several steps:
</p>
<ul class="itemize mark-bullet">
<li>You must compile and link your program with profiling enabled.
See <a class="xref" href="#Compiling">Compiling a Program for Profiling</a>.

</li><li>You must execute your program to generate a profile data file.
See <a class="xref" href="#Executing">Executing the Program</a>.

</li><li>You must run <code class="code">gprof</code> to analyze the profile data.
See <a class="xref" href="#Invoking"><code class="code">gprof</code> Command Summary</a>.
</li></ul>

<p>The next three chapters explain these steps in greater detail.
</p>

<p>Several forms of output are available from the analysis.
</p>
<p>The <em class="dfn">flat profile</em> shows how much time your program spent in each function,
and how many times that function was called.  If you simply want to know
which functions burn most of the cycles, it is stated concisely here.
See <a class="xref" href="#Flat-Profile">The Flat Profile</a>.
</p>
<p>The <em class="dfn">call graph</em> shows, for each function, which functions called it, which
other functions it called, and how many times.  There is also an estimate
of how much time was spent in the subroutines of each function.  This can
suggest places where you might try to eliminate function calls that use a
lot of time.  See <a class="xref" href="#Call-Graph">The Call Graph</a>.
</p>
<p>The <em class="dfn">annotated source</em> listing is a copy of the program&rsquo;s
source code, labeled with the number of times each line of the
program was executed.  See <a class="xref" href="#Annotated-Source">The Annotated Source
Listing</a>.
</p>
<p>To better understand how profiling works, you may wish to read
a description of its implementation.
See <a class="xref" href="#Implementation">Implementation of Profiling</a>.
</p>
<hr>
</div>
<div class="chapter-level-extent" id="Compiling">
<div class="nav-panel">
<p>
Next: <a href="#Executing" accesskey="n" rel="next">Executing the Program</a>, Previous: <a href="#Introduction" accesskey="p" rel="prev">Introduction to Profiling</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Compiling-a-Program-for-Profiling"><span>2 Compiling a Program for Profiling<a class="copiable-link" href="#Compiling-a-Program-for-Profiling"> &para;</a></span></h2>

<p>The first step in generating profile information for your program is
to compile and link it with profiling enabled.
</p>
<p>To compile a source file for profiling, specify the &lsquo;<samp class="samp">-pg</samp>&rsquo; option when
you run the compiler.  (This is in addition to the options you normally
use.)
</p>
<p>To link the program for profiling, if you use a compiler such as <code class="code">cc</code>
to do the linking, simply specify &lsquo;<samp class="samp">-pg</samp>&rsquo; in addition to your usual
options.  The same option, &lsquo;<samp class="samp">-pg</samp>&rsquo;, alters either compilation or linking
to do what is necessary for profiling.  Here are examples:
</p>
<div class="example">
<pre class="example-preformatted">cc -g -c myprog.c utils.c -pg
cc -o myprog myprog.o utils.o -pg
</pre></div>

<p>The &lsquo;<samp class="samp">-pg</samp>&rsquo; option also works with a command that both compiles and links:
</p>
<div class="example">
<pre class="example-preformatted">cc -o myprog myprog.c utils.c -g -pg
</pre></div>

<p>Note: The &lsquo;<samp class="samp">-pg</samp>&rsquo; option must be part of your compilation options
as well as your link options.  If it is not then no call-graph data
will be gathered and when you run <code class="code">gprof</code> you will get an error
message like this:
</p>
<div class="example">
<pre class="example-preformatted">gprof: gmon.out file is missing call-graph data
</pre></div>

<p>If you add the &lsquo;<samp class="samp">-Q</samp>&rsquo; switch to suppress the printing of the call
graph data you will still be able to see the time samples:
</p>
<div class="example">
<pre class="example-preformatted">Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  Ts/call  Ts/call  name
 44.12      0.07     0.07                             zazLoop
 35.29      0.14     0.06                             main
 20.59      0.17     0.04                             bazMillion
</pre></div>

<p>If you run the linker <code class="code">ld</code> directly instead of through a compiler
such as <code class="code">cc</code>, you may have to specify a profiling startup file
<samp class="file">gcrt0.o</samp> as the first input file instead of the usual startup
file <samp class="file">crt0.o</samp>.  In addition, you would probably want to
specify the profiling C library, <samp class="file">libc_p.a</samp>, by writing
&lsquo;<samp class="samp">-lc_p</samp>&rsquo; instead of the usual &lsquo;<samp class="samp">-lc</samp>&rsquo;.  This is not absolutely
necessary, but doing this gives you number-of-calls information for
standard library functions such as <code class="code">read</code> and <code class="code">open</code>.  For
example:
</p>
<div class="example">
<pre class="example-preformatted">ld -o myprog /lib/gcrt0.o myprog.o utils.o -lc_p
</pre></div>

<p>If you are running the program on a system which supports shared
libraries you may run into problems with the profiling support code in
a shared library being called before that library has been fully
initialised.  This is usually detected by the program encountering a
segmentation fault as soon as it is run.  The solution is to link
against a static version of the library containing the profiling
support code, which for <code class="code">gcc</code> users can be done via the
&lsquo;<samp class="samp">-static</samp>&rsquo; or &lsquo;<samp class="samp">-static-libgcc</samp>&rsquo; command-line option.  For
example:
</p>
<div class="example">
<pre class="example-preformatted">gcc -g -pg -static-libgcc myprog.c utils.c -o myprog
</pre></div>

<p>If you compile only some of the modules of the program with &lsquo;<samp class="samp">-pg</samp>&rsquo;, you
can still profile the program, but you won&rsquo;t get complete information about
the modules that were compiled without &lsquo;<samp class="samp">-pg</samp>&rsquo;.  The only information
you get for the functions in those modules is the total time spent in them;
there is no record of how many times they were called, or from where.  This
will not affect the flat profile (except that the <code class="code">calls</code> field for
the functions will be blank), but will greatly reduce the usefulness of the
call graph.
</p>
<p>If you wish to perform line-by-line profiling you should use the
<code class="code">gcov</code> tool instead of <code class="code">gprof</code>.  See that tool&rsquo;s manual or
info pages for more details of how to do this.
</p>
<p>Note, older versions of <code class="code">gcc</code> produce line-by-line profiling
information that works with <code class="code">gprof</code> rather than <code class="code">gcov</code> so
there is still support for displaying this kind of information in
<code class="code">gprof</code>. See <a class="xref" href="#Line_002dby_002dline">Line-by-line Profiling</a>.
</p>
<p>It also worth noting that <code class="code">gcc</code> implements a
&lsquo;<samp class="samp">-finstrument-functions</samp>&rsquo; command-line option which will insert
calls to special user supplied instrumentation routines at the entry
and exit of every function in their program.  This can be used to
implement an alternative profiling scheme.
</p>
<hr>
</div>
<div class="chapter-level-extent" id="Executing">
<div class="nav-panel">
<p>
Next: <a href="#Invoking" accesskey="n" rel="next"><code class="code">gprof</code> Command Summary</a>, Previous: <a href="#Compiling" accesskey="p" rel="prev">Compiling a Program for Profiling</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Executing-the-Program"><span>3 Executing the Program<a class="copiable-link" href="#Executing-the-Program"> &para;</a></span></h2>

<p>Once the program is compiled for profiling, you must run it in order to
generate the information that <code class="code">gprof</code> needs.  Simply run the program
as usual, using the normal arguments, file names, etc.  The program should
run normally, producing the same output as usual.  It will, however, run
somewhat slower than normal because of the time spent collecting and
writing the profile data.
</p>
<p>The way you run the program&mdash;the arguments and input that you give
it&mdash;may have a dramatic effect on what the profile information shows.  The
profile data will describe the parts of the program that were activated for
the particular input you use.  For example, if the first command you give
to your program is to quit, the profile data will show the time used in
initialization and in cleanup, but not much else.
</p>
<p>Your program will write the profile data into a file called <samp class="file">gmon.out</samp>
just before exiting.  If there is already a file called <samp class="file">gmon.out</samp>,
its contents are overwritten.  You can rename the file afterwards if you
are concerned that it may be overwritten.  If your system libc allows you
may be able to write the profile data under a different name.  Set the
GMON_OUT_PREFIX environment variable; this name will be appended with
the PID of the running program.
</p>
<p>In order to write the <samp class="file">gmon.out</samp> file properly, your program must exit
normally: by returning from <code class="code">main</code> or by calling <code class="code">exit</code>.  Calling
the low-level function <code class="code">_exit</code> does not write the profile data, and
neither does abnormal termination due to an unhandled signal.
</p>
<p>The <samp class="file">gmon.out</samp> file is written in the program&rsquo;s <em class="emph">current working
directory</em> at the time it exits.  This means that if your program calls
<code class="code">chdir</code>, the <samp class="file">gmon.out</samp> file will be left in the last directory
your program <code class="code">chdir</code>&rsquo;d to.  If you don&rsquo;t have permission to write in
this directory, the file is not written, and you will get an error message.
</p>
<p>Older versions of the <small class="sc">GNU</small> profiling library may also write a file
called <samp class="file">bb.out</samp>.  This file, if present, contains an human-readable
listing of the basic-block execution counts.  Unfortunately, the
appearance of a human-readable <samp class="file">bb.out</samp> means the basic-block
counts didn&rsquo;t get written into <samp class="file">gmon.out</samp>.
The Perl script <code class="code">bbconv.pl</code>, included with the <code class="code">gprof</code>
source distribution, will convert a <samp class="file">bb.out</samp> file into
a format readable by <code class="code">gprof</code>.  Invoke it like this:
</p>
<div class="example smallexample">
<pre class="example-preformatted">bbconv.pl &lt; bb.out &gt; <var class="var">bh-data</var>
</pre></div>

<p>This translates the information in <samp class="file">bb.out</samp> into a form that
<code class="code">gprof</code> can understand.  But you still need to tell <code class="code">gprof</code>
about the existence of this translated information.  To do that, include
<var class="var">bb-data</var> on the <code class="code">gprof</code> command line, <em class="emph">along with
<samp class="file">gmon.out</samp></em>, like this:
</p>
<div class="example smallexample">
<pre class="example-preformatted">gprof <var class="var">options</var> <var class="var">executable-file</var> gmon.out <var class="var">bb-data</var> [<var class="var">yet-more-profile-data-files</var>...] [&gt; <var class="var">outfile</var>]
</pre></div>

<hr>
</div>
<div class="chapter-level-extent" id="Invoking">
<div class="nav-panel">
<p>
Next: <a href="#Output" accesskey="n" rel="next">Interpreting <code class="code">gprof</code>&rsquo;s Output</a>, Previous: <a href="#Executing" accesskey="p" rel="prev">Executing the Program</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="gprof-Command-Summary"><span>4 <code class="code">gprof</code> Command Summary<a class="copiable-link" href="#gprof-Command-Summary"> &para;</a></span></h2>

<p>After you have a profile data file <samp class="file">gmon.out</samp>, you can run <code class="code">gprof</code>
to interpret the information in it.  The <code class="code">gprof</code> program prints a
flat profile and a call graph on standard output.  Typically you would
redirect the output of <code class="code">gprof</code> into a file with &lsquo;<samp class="samp">&gt;</samp>&rsquo;.
</p>
<p>You run <code class="code">gprof</code> like this:
</p>
<div class="example smallexample">
<pre class="example-preformatted">gprof <var class="var">options</var> [<var class="var">executable-file</var> [<var class="var">profile-data-files</var>...]] [&gt; <var class="var">outfile</var>]
</pre></div>

<p>Here square-brackets indicate optional arguments.
</p>
<p>If you omit the executable file name, the file <samp class="file">a.out</samp> is used.  If
you give no profile data file name, the file <samp class="file">gmon.out</samp> is used.  If
any file is not in the proper format, or if the profile data file does not
appear to belong to the executable file, an error message is printed.
</p>
<p>You can give more than one profile data file by entering all their names
after the executable file name; then the statistics in all the data files
are summed together.
</p>
<p>The order of these options does not matter.
</p>

<ul class="mini-toc">
<li><a href="#Output-Options" accesskey="1">Output Options</a></li>
<li><a href="#Analysis-Options" accesskey="2">Analysis Options</a></li>
<li><a href="#Miscellaneous-Options" accesskey="3">Miscellaneous Options</a></li>
<li><a href="#Deprecated-Options" accesskey="4">Deprecated Options</a></li>
<li><a href="#Symspecs" accesskey="5">Symspecs</a></li>
</ul>
<hr>
<div class="section-level-extent" id="Output-Options">
<div class="nav-panel">
<p>
Next: <a href="#Analysis-Options" accesskey="n" rel="next">Analysis Options</a>, Up: <a href="#Invoking" accesskey="u" rel="up"><code class="code">gprof</code> Command Summary</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Output-Options-1"><span>4.1 Output Options<a class="copiable-link" href="#Output-Options-1"> &para;</a></span></h3>

<p>These options specify which of several output formats
<code class="code">gprof</code> should produce.
</p>
<p>Many of these options take an optional <em class="dfn">symspec</em> to specify
functions to be included or excluded.  These options can be
specified multiple times, with different symspecs, to include
or exclude sets of symbols.  See <a class="xref" href="#Symspecs">Symspecs</a>.
</p>
<p>Specifying any of these options overrides the default (&lsquo;<samp class="samp">-p -q</samp>&rsquo;),
which prints a flat profile and call graph analysis
for all functions.
</p>
<dl class="table">
<dt><code class="code">-A[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--annotated-source[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-A</samp>&rsquo; option causes <code class="code">gprof</code> to print annotated source code.
If <var class="var">symspec</var> is specified, print output only for matching symbols.
See <a class="xref" href="#Annotated-Source">The Annotated Source Listing</a>.
</p>
</dd>
<dt><code class="code">-b</code></dt>
<dt><code class="code">--brief</code></dt>
<dd><p>If the &lsquo;<samp class="samp">-b</samp>&rsquo; option is given, <code class="code">gprof</code> doesn&rsquo;t print the
verbose blurbs that try to explain the meaning of all of the fields in
the tables.  This is useful if you intend to print out the output, or
are tired of seeing the blurbs.
</p>
</dd>
<dt><code class="code">-B</code></dt>
<dd><p>The &lsquo;<samp class="samp">-B</samp>&rsquo; option causes <code class="code">gprof</code> to print the call graph analysis.
</p>
</dd>
<dt><code class="code">-C[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--exec-counts[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-C</samp>&rsquo; option causes <code class="code">gprof</code> to
print a tally of functions and the number of times each was called.
If <var class="var">symspec</var> is specified, print tally only for matching symbols.
</p>
<p>If the profile data file contains basic-block count records, specifying
the &lsquo;<samp class="samp">-l</samp>&rsquo; option, along with &lsquo;<samp class="samp">-C</samp>&rsquo;, will cause basic-block
execution counts to be tallied and displayed.
</p>
</dd>
<dt><code class="code">-i</code></dt>
<dt><code class="code">--file-info</code></dt>
<dd><p>The &lsquo;<samp class="samp">-i</samp>&rsquo; option causes <code class="code">gprof</code> to display summary information
about the profile data file(s) and then exit.  The number of histogram,
call graph, and basic-block count records is displayed.
</p>
</dd>
<dt><code class="code">-I <var class="var">dirs</var></code></dt>
<dt><code class="code">--directory-path=<var class="var">dirs</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-I</samp>&rsquo; option specifies a list of search directories in
which to find source files.  Environment variable <var class="var">GPROF_PATH</var>
can also be used to convey this information.
Used mostly for annotated source output.
</p>
</dd>
<dt><code class="code">-J[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--no-annotated-source[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-J</samp>&rsquo; option causes <code class="code">gprof</code> not to
print annotated source code.
If <var class="var">symspec</var> is specified, <code class="code">gprof</code> prints annotated source,
but excludes matching symbols.
</p>
</dd>
<dt><code class="code">-L</code></dt>
<dt><code class="code">--print-path</code></dt>
<dd><p>Normally, source filenames are printed with the path
component suppressed.  The &lsquo;<samp class="samp">-L</samp>&rsquo; option causes <code class="code">gprof</code>
to print the full pathname of
source filenames, which is determined
from symbolic debugging information in the image file
and is relative to the directory in which the compiler
was invoked.
</p>
</dd>
<dt><code class="code">-p[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--flat-profile[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-p</samp>&rsquo; option causes <code class="code">gprof</code> to print a flat profile.
If <var class="var">symspec</var> is specified, print flat profile only for matching symbols.
See <a class="xref" href="#Flat-Profile">The Flat Profile</a>.
</p>
</dd>
<dt><code class="code">-P[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--no-flat-profile[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-P</samp>&rsquo; option causes <code class="code">gprof</code> to suppress printing a flat profile.
If <var class="var">symspec</var> is specified, <code class="code">gprof</code> prints a flat profile,
but excludes matching symbols.
</p>
</dd>
<dt><code class="code">-q[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--graph[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-q</samp>&rsquo; option causes <code class="code">gprof</code> to print the call graph analysis.
If <var class="var">symspec</var> is specified, print call graph only for matching symbols
and their children.
See <a class="xref" href="#Call-Graph">The Call Graph</a>.
</p>
</dd>
<dt><code class="code">-Q[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--no-graph[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-Q</samp>&rsquo; option causes <code class="code">gprof</code> to suppress printing the
call graph.
If <var class="var">symspec</var> is specified, <code class="code">gprof</code> prints a call graph,
but excludes matching symbols.
</p>
</dd>
<dt><code class="code">-t</code></dt>
<dt><code class="code">--table-length=<var class="var">num</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-t</samp>&rsquo; option causes the <var class="var">num</var> most active source lines in
each source file to be listed when source annotation is enabled.  The
default is 10.
</p>
</dd>
<dt><code class="code">-y</code></dt>
<dt><code class="code">--separate-files</code></dt>
<dd><p>This option affects annotated source output only.
Normally, <code class="code">gprof</code> prints annotated source files
to standard-output.  If this option is specified,
annotated source for a file named <samp class="file">path/<var class="var">filename</var></samp>
is generated in the file <samp class="file"><var class="var">filename</var>-ann</samp>.  If the underlying
file system would truncate <samp class="file"><var class="var">filename</var>-ann</samp> so that it
overwrites the original <samp class="file"><var class="var">filename</var></samp>, <code class="code">gprof</code> generates
annotated source in the file <samp class="file"><var class="var">filename</var>.ann</samp> instead (if the
original file name has an extension, that extension is <em class="emph">replaced</em>
with <samp class="file">.ann</samp>).
</p>
</dd>
<dt><code class="code">-Z[<var class="var">symspec</var>]</code></dt>
<dt><code class="code">--no-exec-counts[=<var class="var">symspec</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-Z</samp>&rsquo; option causes <code class="code">gprof</code> not to
print a tally of functions and the number of times each was called.
If <var class="var">symspec</var> is specified, print tally, but exclude matching symbols.
</p>
</dd>
<dt><code class="code">-r</code></dt>
<dt><code class="code">--function-ordering</code></dt>
<dd><p>The &lsquo;<samp class="samp">--function-ordering</samp>&rsquo; option causes <code class="code">gprof</code> to print a
suggested function ordering for the program based on profiling data.
This option suggests an ordering which may improve paging, tlb and
cache behavior for the program on systems which support arbitrary
ordering of functions in an executable.
</p>
<p>The exact details of how to force the linker to place functions
in a particular order is system dependent and out of the scope of this
manual.
</p>
</dd>
<dt><code class="code">-R <var class="var">map_file</var></code></dt>
<dt><code class="code">--file-ordering <var class="var">map_file</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">--file-ordering</samp>&rsquo; option causes <code class="code">gprof</code> to print a
suggested .o link line ordering for the program based on profiling data.
This option suggests an ordering which may improve paging, tlb and
cache behavior for the program on systems which do not support arbitrary
ordering of functions in an executable.
</p>
<p>Use of the &lsquo;<samp class="samp">-a</samp>&rsquo; argument is highly recommended with this option.
</p>
<p>The <var class="var">map_file</var> argument is a pathname to a file which provides
function name to object file mappings.  The format of the file is similar to
the output of the program <code class="code">nm</code>.
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">c-parse.o:00000000 T yyparse
c-parse.o:00000004 C yyerrflag
c-lang.o:00000000 T maybe_objc_method_name
c-lang.o:00000000 T print_lang_statistics
c-lang.o:00000000 T recognize_objc_keyword
c-decl.o:00000000 T print_lang_identifier
c-decl.o:00000000 T print_lang_type
...

</pre></div></div>

<p>To create a <var class="var">map_file</var> with <small class="sc">GNU</small> <code class="code">nm</code>, type a command like
<kbd class="kbd">nm --extern-only --defined-only -v --print-file-name program-name</kbd>.
</p>
</dd>
<dt><code class="code">-T</code></dt>
<dt><code class="code">--traditional</code></dt>
<dd><p>The &lsquo;<samp class="samp">-T</samp>&rsquo; option causes <code class="code">gprof</code> to print its output in
&ldquo;traditional&rdquo; BSD style.
</p>
</dd>
<dt><code class="code">-w <var class="var">width</var></code></dt>
<dt><code class="code">--width=<var class="var">width</var></code></dt>
<dd><p>Sets width of output lines to <var class="var">width</var>.
Currently only used when printing the function index at the bottom
of the call graph.
</p>
</dd>
<dt><code class="code">-x</code></dt>
<dt><code class="code">--all-lines</code></dt>
<dd><p>This option affects annotated source output only.
By default, only the lines at the beginning of a basic-block
are annotated.  If this option is specified, every line in
a basic-block is annotated by repeating the annotation for the
first line.  This behavior is similar to <code class="code">tcov</code>&rsquo;s &lsquo;<samp class="samp">-a</samp>&rsquo;.
</p>
</dd>
<dt><code class="code">--demangle[=<var class="var">style</var>]</code></dt>
<dt><code class="code">--no-demangle</code></dt>
<dd><p>These options control whether C++ symbol names should be demangled when
printing output.  The default is to demangle symbols.  The
<code class="code">--no-demangle</code> option may be used to turn off demangling. Different
compilers have different mangling styles.  The optional demangling style
argument can be used to choose an appropriate demangling style for your
compiler.
</p></dd>
</dl>

<hr>
</div>
<div class="section-level-extent" id="Analysis-Options">
<div class="nav-panel">
<p>
Next: <a href="#Miscellaneous-Options" accesskey="n" rel="next">Miscellaneous Options</a>, Previous: <a href="#Output-Options" accesskey="p" rel="prev">Output Options</a>, Up: <a href="#Invoking" accesskey="u" rel="up"><code class="code">gprof</code> Command Summary</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Analysis-Options-1"><span>4.2 Analysis Options<a class="copiable-link" href="#Analysis-Options-1"> &para;</a></span></h3>

<dl class="table">
<dt><code class="code">-a</code></dt>
<dt><code class="code">--no-static</code></dt>
<dd><p>The &lsquo;<samp class="samp">-a</samp>&rsquo; option causes <code class="code">gprof</code> to suppress the printing of
statically declared (private) functions.  (These are functions whose
names are not listed as global, and which are not visible outside the
file/function/block where they were defined.)  Time spent in these
functions, calls to/from them, etc., will all be attributed to the
function that was loaded directly before it in the executable file.
This option affects both the flat profile and the call graph.
</p>
</dd>
<dt><code class="code">-c</code></dt>
<dt><code class="code">--static-call-graph</code></dt>
<dd><p>The &lsquo;<samp class="samp">-c</samp>&rsquo; option causes the call graph of the program to be
augmented by a heuristic which examines the text space of the object
file and identifies function calls in the binary machine code.
Since normal call graph records are only generated when functions are
entered, this option identifies children that could have been called,
but never were.  Calls to functions that were not compiled with
profiling enabled are also identified, but only if symbol table
entries are present for them.
Calls to dynamic library routines are typically <em class="emph">not</em> found
by this option.
Parents or children identified via this heuristic
are indicated in the call graph with call counts of &lsquo;<samp class="samp">0</samp>&rsquo;.
</p>
</dd>
<dt><code class="code">-D</code></dt>
<dt><code class="code">--ignore-non-functions</code></dt>
<dd><p>The &lsquo;<samp class="samp">-D</samp>&rsquo; option causes <code class="code">gprof</code> to ignore symbols which
are not known to be functions.  This option will give more accurate
profile data on systems where it is supported (Solaris and HPUX for
example).
</p>
</dd>
<dt><code class="code">-k <var class="var">from</var>/<var class="var">to</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-k</samp>&rsquo; option allows you to delete from the call graph any arcs from
symbols matching symspec <var class="var">from</var> to those matching symspec <var class="var">to</var>.
</p>
</dd>
<dt><code class="code">-l</code></dt>
<dt><code class="code">--line</code></dt>
<dd><p>The &lsquo;<samp class="samp">-l</samp>&rsquo; option enables line-by-line profiling, which causes
histogram hits to be charged to individual source code lines,
instead of functions.  This feature only works with programs compiled
by older versions of the <code class="code">gcc</code> compiler.  Newer versions of
<code class="code">gcc</code> are designed to work with the <code class="code">gcov</code> tool instead.
</p>
<p>If the program was compiled with basic-block counting enabled,
this option will also identify how many times each line of
code was executed.
While line-by-line profiling can help isolate where in a large function
a program is spending its time, it also significantly increases
the running time of <code class="code">gprof</code>, and magnifies statistical
inaccuracies.
See <a class="xref" href="#Sampling-Error">Statistical Sampling Error</a>.
</p>
</dd>
<dt><code class="code">--inline-file-names</code></dt>
<dd><p>This option causes <code class="code">gprof</code> to print the source file after each
symbol in both the flat profile and the call graph. The full path to the
file is printed if used with the &lsquo;<samp class="samp">-L</samp>&rsquo; option.
</p>
</dd>
<dt><code class="code">-m <var class="var">num</var></code></dt>
<dt><code class="code">--min-count=<var class="var">num</var></code></dt>
<dd><p>This option affects execution count output only.
Symbols that are executed less than <var class="var">num</var> times are suppressed.
</p>
</dd>
<dt><code class="code">-n<var class="var">symspec</var></code></dt>
<dt><code class="code">--time=<var class="var">symspec</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-n</samp>&rsquo; option causes <code class="code">gprof</code>, in its call graph analysis,
to only propagate times for symbols matching <var class="var">symspec</var>.
</p>
</dd>
<dt><code class="code">-N<var class="var">symspec</var></code></dt>
<dt><code class="code">--no-time=<var class="var">symspec</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-n</samp>&rsquo; option causes <code class="code">gprof</code>, in its call graph analysis,
not to propagate times for symbols matching <var class="var">symspec</var>.
</p>
</dd>
<dt><code class="code">-S<var class="var">filename</var></code></dt>
<dt><code class="code">--external-symbol-table=<var class="var">filename</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-S</samp>&rsquo; option causes <code class="code">gprof</code> to read an external symbol table
file, such as <samp class="file">/proc/kallsyms</samp>, rather than read the symbol table
from the given object file (the default is <code class="code">a.out</code>). This is useful
for profiling kernel modules.
</p>
</dd>
<dt><code class="code">-z</code></dt>
<dt><code class="code">--display-unused-functions</code></dt>
<dd><p>If you give the &lsquo;<samp class="samp">-z</samp>&rsquo; option, <code class="code">gprof</code> will mention all
functions in the flat profile, even those that were never called, and
that had no time spent in them.  This is useful in conjunction with the
&lsquo;<samp class="samp">-c</samp>&rsquo; option for discovering which routines were never called.
</p>
</dd>
</dl>

<hr>
</div>
<div class="section-level-extent" id="Miscellaneous-Options">
<div class="nav-panel">
<p>
Next: <a href="#Deprecated-Options" accesskey="n" rel="next">Deprecated Options</a>, Previous: <a href="#Analysis-Options" accesskey="p" rel="prev">Analysis Options</a>, Up: <a href="#Invoking" accesskey="u" rel="up"><code class="code">gprof</code> Command Summary</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Miscellaneous-Options-1"><span>4.3 Miscellaneous Options<a class="copiable-link" href="#Miscellaneous-Options-1"> &para;</a></span></h3>

<dl class="table">
<dt><code class="code">-d[<var class="var">num</var>]</code></dt>
<dt><code class="code">--debug[=<var class="var">num</var>]</code></dt>
<dd><p>The &lsquo;<samp class="samp">-d <var class="var">num</var></samp>&rsquo; option specifies debugging options.
If <var class="var">num</var> is not specified, enable all debugging.
See <a class="xref" href="#Debugging">Debugging <code class="code">gprof</code></a>.
</p>
</dd>
<dt><code class="code">-h</code></dt>
<dt><code class="code">--help</code></dt>
<dd><p>The &lsquo;<samp class="samp">-h</samp>&rsquo; option prints command line usage.
</p>
</dd>
<dt><code class="code">-O<var class="var">name</var></code></dt>
<dt><code class="code">--file-format=<var class="var">name</var></code></dt>
<dd><p>Selects the format of the profile data files.  Recognized formats are
&lsquo;<samp class="samp">auto</samp>&rsquo; (the default), &lsquo;<samp class="samp">bsd</samp>&rsquo;, &lsquo;<samp class="samp">4.4bsd</samp>&rsquo;, &lsquo;<samp class="samp">magic</samp>&rsquo;, and
&lsquo;<samp class="samp">prof</samp>&rsquo; (not yet supported).
</p>
</dd>
<dt><code class="code">-s</code></dt>
<dt><code class="code">--sum</code></dt>
<dd><p>The &lsquo;<samp class="samp">-s</samp>&rsquo; option causes <code class="code">gprof</code> to summarize the information
in the profile data files it read in, and write out a profile data
file called <samp class="file">gmon.sum</samp>, which contains all the information from
the profile data files that <code class="code">gprof</code> read in.  The file <samp class="file">gmon.sum</samp>
may be one of the specified input files; the effect of this is to
merge the data in the other input files into <samp class="file">gmon.sum</samp>.
</p>
<p>Eventually you can run <code class="code">gprof</code> again without &lsquo;<samp class="samp">-s</samp>&rsquo; to analyze the
cumulative data in the file <samp class="file">gmon.sum</samp>.
</p>
</dd>
<dt><code class="code">-v</code></dt>
<dt><code class="code">--version</code></dt>
<dd><p>The &lsquo;<samp class="samp">-v</samp>&rsquo; flag causes <code class="code">gprof</code> to print the current version
number, and then exit.
</p>
</dd>
</dl>

<hr>
</div>
<div class="section-level-extent" id="Deprecated-Options">
<div class="nav-panel">
<p>
Next: <a href="#Symspecs" accesskey="n" rel="next">Symspecs</a>, Previous: <a href="#Miscellaneous-Options" accesskey="p" rel="prev">Miscellaneous Options</a>, Up: <a href="#Invoking" accesskey="u" rel="up"><code class="code">gprof</code> Command Summary</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Deprecated-Options-1"><span>4.4 Deprecated Options<a class="copiable-link" href="#Deprecated-Options-1"> &para;</a></span></h3>

<p>These options have been replaced with newer versions that use symspecs.
</p>
<dl class="table">
<dt><code class="code">-e <var class="var">function_name</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-e <var class="var">function</var></samp>&rsquo; option tells <code class="code">gprof</code> to not print
information about the function <var class="var">function_name</var> (and its
children&hellip;) in the call graph.  The function will still be listed
as a child of any functions that call it, but its index number will be
shown as &lsquo;<samp class="samp">[not printed]</samp>&rsquo;.  More than one &lsquo;<samp class="samp">-e</samp>&rsquo; option may be
given; only one <var class="var">function_name</var> may be indicated with each &lsquo;<samp class="samp">-e</samp>&rsquo;
option.
</p>
</dd>
<dt><code class="code">-E <var class="var">function_name</var></code></dt>
<dd><p>The <code class="code">-E <var class="var">function</var></code> option works like the <code class="code">-e</code> option, but
time spent in the function (and children who were not called from
anywhere else), will not be used to compute the percentages-of-time for
the call graph.  More than one &lsquo;<samp class="samp">-E</samp>&rsquo; option may be given; only one
<var class="var">function_name</var> may be indicated with each &lsquo;<samp class="samp">-E</samp>&rsquo; option.
</p>
</dd>
<dt><code class="code">-f <var class="var">function_name</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-f <var class="var">function</var></samp>&rsquo; option causes <code class="code">gprof</code> to limit the
call graph to the function <var class="var">function_name</var> and its children (and
their children&hellip;).  More than one &lsquo;<samp class="samp">-f</samp>&rsquo; option may be given;
only one <var class="var">function_name</var> may be indicated with each &lsquo;<samp class="samp">-f</samp>&rsquo;
option.
</p>
</dd>
<dt><code class="code">-F <var class="var">function_name</var></code></dt>
<dd><p>The &lsquo;<samp class="samp">-F <var class="var">function</var></samp>&rsquo; option works like the <code class="code">-f</code> option, but
only time spent in the function and its children (and their
children&hellip;) will be used to determine total-time and
percentages-of-time for the call graph.  More than one &lsquo;<samp class="samp">-F</samp>&rsquo; option
may be given; only one <var class="var">function_name</var> may be indicated with each
&lsquo;<samp class="samp">-F</samp>&rsquo; option.  The &lsquo;<samp class="samp">-F</samp>&rsquo; option overrides the &lsquo;<samp class="samp">-E</samp>&rsquo; option.
</p>
</dd>
</dl>


<p>Note that only one function can be specified with each <code class="code">-e</code>,
<code class="code">-E</code>, <code class="code">-f</code> or <code class="code">-F</code> option.  To specify more than one
function, use multiple options.  For example, this command:
</p>
<div class="example">
<pre class="example-preformatted">gprof -e boring -f foo -f bar myprogram &gt; gprof.output
</pre></div>

<p>lists in the call graph all functions that were reached from either
<code class="code">foo</code> or <code class="code">bar</code> and were not reachable from <code class="code">boring</code>.
</p>
<hr>
</div>
<div class="section-level-extent" id="Symspecs">
<div class="nav-panel">
<p>
Previous: <a href="#Deprecated-Options" accesskey="p" rel="prev">Deprecated Options</a>, Up: <a href="#Invoking" accesskey="u" rel="up"><code class="code">gprof</code> Command Summary</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Symspecs-1"><span>4.5 Symspecs<a class="copiable-link" href="#Symspecs-1"> &para;</a></span></h3>

<p>Many of the output options allow functions to be included or excluded
using <em class="dfn">symspecs</em> (symbol specifications), which observe the
following syntax:
</p>
<div class="example">
<pre class="example-preformatted">  filename_containing_a_dot
| funcname_not_containing_a_dot
| linenumber
| ( [ any_filename ] `:' ( any_funcname | linenumber ) )
</pre></div>

<p>Here are some sample symspecs:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">main.c</samp>&rsquo;</dt>
<dd><p>Selects everything in file <samp class="file">main.c</samp>&mdash;the
dot in the string tells <code class="code">gprof</code> to interpret
the string as a filename, rather than as
a function name.  To select a file whose
name does not contain a dot, a trailing colon
should be specified.  For example, &lsquo;<samp class="samp">odd:</samp>&rsquo; is
interpreted as the file named <samp class="file">odd</samp>.
</p>
</dd>
<dt>&lsquo;<samp class="samp">main</samp>&rsquo;</dt>
<dd><p>Selects all functions named &lsquo;<samp class="samp">main</samp>&rsquo;.
</p>
<p>Note that there may be multiple instances of the same function name
because some of the definitions may be local (i.e., static).  Unless a
function name is unique in a program, you must use the colon notation
explained below to specify a function from a specific source file.
</p>
<p>Sometimes, function names contain dots.  In such cases, it is necessary
to add a leading colon to the name.  For example, &lsquo;<samp class="samp">:.mul</samp>&rsquo; selects
function &lsquo;<samp class="samp">.mul</samp>&rsquo;.
</p>
<p>In some object file formats, symbols have a leading underscore.
<code class="code">gprof</code> will normally not print these underscores.  When you name a
symbol in a symspec, you should type it exactly as <code class="code">gprof</code> prints
it in its output.  For example, if the compiler produces a symbol
&lsquo;<samp class="samp">_main</samp>&rsquo; from your <code class="code">main</code> function, <code class="code">gprof</code> still prints
it as &lsquo;<samp class="samp">main</samp>&rsquo; in its output, so you should use &lsquo;<samp class="samp">main</samp>&rsquo; in
symspecs.
</p>
</dd>
<dt>&lsquo;<samp class="samp">main.c:main</samp>&rsquo;</dt>
<dd><p>Selects function &lsquo;<samp class="samp">main</samp>&rsquo; in file <samp class="file">main.c</samp>.
</p>
</dd>
<dt>&lsquo;<samp class="samp">main.c:134</samp>&rsquo;</dt>
<dd><p>Selects line 134 in file <samp class="file">main.c</samp>.
</p></dd>
</dl>

<hr>
</div>
</div>
<div class="chapter-level-extent" id="Output">
<div class="nav-panel">
<p>
Next: <a href="#Inaccuracy" accesskey="n" rel="next">Inaccuracy of <code class="code">gprof</code> Output</a>, Previous: <a href="#Invoking" accesskey="p" rel="prev"><code class="code">gprof</code> Command Summary</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Interpreting-gprof_0027s-Output"><span>5 Interpreting <code class="code">gprof</code>&rsquo;s Output<a class="copiable-link" href="#Interpreting-gprof_0027s-Output"> &para;</a></span></h2>

<p><code class="code">gprof</code> can produce several different output styles, the
most important of which are described below.  The simplest output
styles (file information, execution count, and function and file ordering)
are not described here, but are documented with the respective options
that trigger them.
See <a class="xref" href="#Output-Options">Output Options</a>.
</p>


<ul class="mini-toc">
<li><a href="#Flat-Profile" accesskey="1">The Flat Profile</a></li>
<li><a href="#Call-Graph" accesskey="2">The Call Graph</a></li>
<li><a href="#Line_002dby_002dline" accesskey="3">Line-by-line Profiling</a></li>
<li><a href="#Annotated-Source" accesskey="4">The Annotated Source Listing</a></li>
</ul>
<hr>
<div class="section-level-extent" id="Flat-Profile">
<div class="nav-panel">
<p>
Next: <a href="#Call-Graph" accesskey="n" rel="next">The Call Graph</a>, Up: <a href="#Output" accesskey="u" rel="up">Interpreting <code class="code">gprof</code>&rsquo;s Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="The-Flat-Profile"><span>5.1 The Flat Profile<a class="copiable-link" href="#The-Flat-Profile"> &para;</a></span></h3>
<a class="index-entry-id" id="index-flat-profile"></a>

<p>The <em class="dfn">flat profile</em> shows the total amount of time your program
spent executing each function.  Unless the &lsquo;<samp class="samp">-z</samp>&rsquo; option is given,
functions with no apparent time spent in them, and no apparent calls
to them, are not mentioned.  Note that if a function was not compiled
for profiling, and didn&rsquo;t run long enough to show up on the program
counter histogram, it will be indistinguishable from a function that
was never called.
</p>
<p>This is part of a flat profile for a small program:
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  ms/call  ms/call  name
 33.34      0.02     0.02     7208     0.00     0.00  open
 16.67      0.03     0.01      244     0.04     0.12  offtime
 16.67      0.04     0.01        8     1.25     1.25  memccpy
 16.67      0.05     0.01        7     1.43     1.43  write
 16.67      0.06     0.01                             mcount
  0.00      0.06     0.00      236     0.00     0.00  tzset
  0.00      0.06     0.00      192     0.00     0.00  tolower
  0.00      0.06     0.00       47     0.00     0.00  strlen
  0.00      0.06     0.00       45     0.00     0.00  strchr
  0.00      0.06     0.00        1     0.00    50.00  main
  0.00      0.06     0.00        1     0.00     0.00  memcpy
  0.00      0.06     0.00        1     0.00    10.11  print
  0.00      0.06     0.00        1     0.00     0.00  profil
  0.00      0.06     0.00        1     0.00    50.00  report
...
</pre></div></div>

<p>The functions are sorted first by decreasing run-time spent in them,
then by decreasing number of calls, then alphabetically by name.  The
functions &lsquo;<samp class="samp">mcount</samp>&rsquo; and &lsquo;<samp class="samp">profil</samp>&rsquo; are part of the profiling
apparatus and appear in every flat profile; their time gives a measure of
the amount of overhead due to profiling.
</p>
<p>Just before the column headers, a statement appears indicating
how much time each sample counted as.
This <em class="dfn">sampling period</em> estimates the margin of error in each of the time
figures.  A time figure that is not much larger than this is not
reliable.  In this example, each sample counted as 0.01 seconds,
suggesting a 100 Hz sampling rate.
The program&rsquo;s total execution time was 0.06
seconds, as indicated by the &lsquo;<samp class="samp">cumulative seconds</samp>&rsquo; field.  Since
each sample counted for 0.01 seconds, this means only six samples
were taken during the run.  Two of the samples occurred while the
program was in the &lsquo;<samp class="samp">open</samp>&rsquo; function, as indicated by the
&lsquo;<samp class="samp">self seconds</samp>&rsquo; field.  Each of the other four samples
occurred one each in &lsquo;<samp class="samp">offtime</samp>&rsquo;, &lsquo;<samp class="samp">memccpy</samp>&rsquo;, &lsquo;<samp class="samp">write</samp>&rsquo;,
and &lsquo;<samp class="samp">mcount</samp>&rsquo;.
Since only six samples were taken, none of these values can
be regarded as particularly reliable.
In another run,
the &lsquo;<samp class="samp">self seconds</samp>&rsquo; field for
&lsquo;<samp class="samp">mcount</samp>&rsquo; might well be &lsquo;<samp class="samp">0.00</samp>&rsquo; or &lsquo;<samp class="samp">0.02</samp>&rsquo;.
See <a class="xref" href="#Sampling-Error">Statistical Sampling Error</a>,
for a complete discussion.
</p>
<p>The remaining functions in the listing (those whose
&lsquo;<samp class="samp">self seconds</samp>&rsquo; field is &lsquo;<samp class="samp">0.00</samp>&rsquo;) didn&rsquo;t appear
in the histogram samples at all.  However, the call graph
indicated that they were called, so therefore they are listed,
sorted in decreasing order by the &lsquo;<samp class="samp">calls</samp>&rsquo; field.
Clearly some time was spent executing these functions,
but the paucity of histogram samples prevents any
determination of how much time each took.
</p>
<p>Here is what the fields in each line mean:
</p>
<dl class="table">
<dt><code class="code">% time</code></dt>
<dd><p>This is the percentage of the total execution time your program spent
in this function.  These should all add up to 100%.
</p>
</dd>
<dt><code class="code">cumulative seconds</code></dt>
<dd><p>This is the cumulative total number of seconds the computer spent
executing this functions, plus the time spent in all the functions
above this one in this table.
</p>
</dd>
<dt><code class="code">self seconds</code></dt>
<dd><p>This is the number of seconds accounted for by this function alone.
The flat profile listing is sorted first by this number.
</p>
</dd>
<dt><code class="code">calls</code></dt>
<dd><p>This is the total number of times the function was called.  If the
function was never called, or the number of times it was called cannot
be determined (probably because the function was not compiled with
profiling enabled), the <em class="dfn">calls</em> field is blank.
</p>
</dd>
<dt><code class="code">self ms/call</code></dt>
<dd><p>This represents the average number of milliseconds spent in this
function per call, if this function is profiled.  Otherwise, this field
is blank for this function.
</p>
</dd>
<dt><code class="code">total ms/call</code></dt>
<dd><p>This represents the average number of milliseconds spent in this
function and its descendants per call, if this function is profiled.
Otherwise, this field is blank for this function.
This is the only field in the flat profile that uses call graph analysis.
</p>
</dd>
<dt><code class="code">name</code></dt>
<dd><p>This is the name of the function.   The flat profile is sorted by this
field alphabetically after the <em class="dfn">self seconds</em> and <em class="dfn">calls</em>
fields are sorted.
</p></dd>
</dl>

<hr>
</div>
<div class="section-level-extent" id="Call-Graph">
<div class="nav-panel">
<p>
Next: <a href="#Line_002dby_002dline" accesskey="n" rel="next">Line-by-line Profiling</a>, Previous: <a href="#Flat-Profile" accesskey="p" rel="prev">The Flat Profile</a>, Up: <a href="#Output" accesskey="u" rel="up">Interpreting <code class="code">gprof</code>&rsquo;s Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="The-Call-Graph"><span>5.2 The Call Graph<a class="copiable-link" href="#The-Call-Graph"> &para;</a></span></h3>
<a class="index-entry-id" id="index-call-graph"></a>

<p>The <em class="dfn">call graph</em> shows how much time was spent in each function
and its children.  From this information, you can find functions that,
while they themselves may not have used much time, called other
functions that did use unusual amounts of time.
</p>
<p>Here is a sample call from a small program.  This call came from the
same <code class="code">gprof</code> run as the flat profile example in the previous
section.
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">granularity: each sample hit covers 2 byte(s) for 20.00% of 0.05 seconds

index % time    self  children    called     name
                                                 &lt;spontaneous&gt;
[1]    100.0    0.00    0.05                 start [1]
                0.00    0.05       1/1           main [2]
                0.00    0.00       1/2           on_exit [28]
                0.00    0.00       1/1           exit [59]
-----------------------------------------------
                0.00    0.05       1/1           start [1]
[2]    100.0    0.00    0.05       1         main [2]
                0.00    0.05       1/1           report [3]
-----------------------------------------------
                0.00    0.05       1/1           main [2]
[3]    100.0    0.00    0.05       1         report [3]
                0.00    0.03       8/8           timelocal [6]
                0.00    0.01       1/1           print [9]
                0.00    0.01       9/9           fgets [12]
                0.00    0.00      12/34          strncmp &lt;cycle 1&gt; [40]
                0.00    0.00       8/8           lookup [20]
                0.00    0.00       1/1           fopen [21]
                0.00    0.00       8/8           chewtime [24]
                0.00    0.00       8/16          skipspace [44]
-----------------------------------------------
[4]     59.8    0.01        0.02       8+472     &lt;cycle 2 as a whole&gt; [4]
                0.01        0.02     244+260         offtime &lt;cycle 2&gt; [7]
                0.00        0.00     236+1           tzset &lt;cycle 2&gt; [26]
-----------------------------------------------
</pre></div></div>

<p>The lines full of dashes divide this table into <em class="dfn">entries</em>, one for each
function.  Each entry has one or more lines.
</p>
<p>In each entry, the primary line is the one that starts with an index number
in square brackets.  The end of this line says which function the entry is
for.  The preceding lines in the entry describe the callers of this
function and the following lines describe its subroutines (also called
<em class="dfn">children</em> when we speak of the call graph).
</p>
<p>The entries are sorted by time spent in the function and its subroutines.
</p>
<p>The internal profiling function <code class="code">mcount</code> (see <a class="pxref" href="#Flat-Profile">The
Flat Profile</a>) is never mentioned in the call graph.
</p>

<ul class="mini-toc">
<li><a href="#Primary" accesskey="1">The Primary Line</a></li>
<li><a href="#Callers" accesskey="2">Lines for a Function&rsquo;s Callers</a></li>
<li><a href="#Subroutines" accesskey="3">Lines for a Function&rsquo;s Subroutines</a></li>
<li><a href="#Cycles" accesskey="4">How Mutually Recursive Functions Are Described</a></li>
</ul>
<hr>
<div class="subsection-level-extent" id="Primary">
<div class="nav-panel">
<p>
Next: <a href="#Callers" accesskey="n" rel="next">Lines for a Function&rsquo;s Callers</a>, Up: <a href="#Call-Graph" accesskey="u" rel="up">The Call Graph</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h4 class="subsection" id="The-Primary-Line"><span>5.2.1 The Primary Line<a class="copiable-link" href="#The-Primary-Line"> &para;</a></span></h4>

<p>The <em class="dfn">primary line</em> in a call graph entry is the line that
describes the function which the entry is about and gives the overall
statistics for this function.
</p>
<p>For reference, we repeat the primary line from the entry for function
<code class="code">report</code> in our main example, together with the heading line that
shows the names of the fields:
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">index  % time    self  children called     name
...
[3]    100.0    0.00    0.05       1         report [3]
</pre></div></div>

<p>Here is what the fields in the primary line mean:
</p>
<dl class="table">
<dt><code class="code">index</code></dt>
<dd><p>Entries are numbered with consecutive integers.  Each function
therefore has an index number, which appears at the beginning of its
primary line.
</p>
<p>Each cross-reference to a function, as a caller or subroutine of
another, gives its index number as well as its name.  The index number
guides you if you wish to look for the entry for that function.
</p>
</dd>
<dt><code class="code">% time</code></dt>
<dd><p>This is the percentage of the total time that was spent in this
function, including time spent in subroutines called from this
function.
</p>
<p>The time spent in this function is counted again for the callers of
this function.  Therefore, adding up these percentages is meaningless.
</p>
</dd>
<dt><code class="code">self</code></dt>
<dd><p>This is the total amount of time spent in this function.  This
should be identical to the number printed in the <code class="code">seconds</code> field
for this function in the flat profile.
</p>
</dd>
<dt><code class="code">children</code></dt>
<dd><p>This is the total amount of time spent in the subroutine calls made by
this function.  This should be equal to the sum of all the <code class="code">self</code>
and <code class="code">children</code> entries of the children listed directly below this
function.
</p>
</dd>
<dt><code class="code">called</code></dt>
<dd><p>This is the number of times the function was called.
</p>
<p>If the function called itself recursively, there are two numbers,
separated by a &lsquo;<samp class="samp">+</samp>&rsquo;.  The first number counts non-recursive calls,
and the second counts recursive calls.
</p>
<p>In the example above, the function <code class="code">report</code> was called once from
<code class="code">main</code>.
</p>
</dd>
<dt><code class="code">name</code></dt>
<dd><p>This is the name of the current function.  The index number is
repeated after it.
</p>
<p>If the function is part of a cycle of recursion, the cycle number is
printed between the function&rsquo;s name and the index number
(see <a class="pxref" href="#Cycles">How Mutually Recursive Functions Are Described</a>).
For example, if function <code class="code">gnurr</code> is part of
cycle number one, and has index number twelve, its primary line would
be end like this:
</p>
<div class="example">
<pre class="example-preformatted">gnurr &lt;cycle 1&gt; [12]
</pre></div>
</dd>
</dl>

<hr>
</div>
<div class="subsection-level-extent" id="Callers">
<div class="nav-panel">
<p>
Next: <a href="#Subroutines" accesskey="n" rel="next">Lines for a Function&rsquo;s Subroutines</a>, Previous: <a href="#Primary" accesskey="p" rel="prev">The Primary Line</a>, Up: <a href="#Call-Graph" accesskey="u" rel="up">The Call Graph</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h4 class="subsection" id="Lines-for-a-Function_0027s-Callers"><span>5.2.2 Lines for a Function&rsquo;s Callers<a class="copiable-link" href="#Lines-for-a-Function_0027s-Callers"> &para;</a></span></h4>

<p>A function&rsquo;s entry has a line for each function it was called by.
These lines&rsquo; fields correspond to the fields of the primary line, but
their meanings are different because of the difference in context.
</p>
<p>For reference, we repeat two lines from the entry for the function
<code class="code">report</code>, the primary line and one caller-line preceding it, together
with the heading line that shows the names of the fields:
</p>
<div class="example smallexample">
<pre class="example-preformatted">index  % time    self  children called     name
...
                0.00    0.05       1/1           main [2]
[3]    100.0    0.00    0.05       1         report [3]
</pre></div>

<p>Here are the meanings of the fields in the caller-line for <code class="code">report</code>
called from <code class="code">main</code>:
</p>
<dl class="table">
<dt><code class="code">self</code></dt>
<dd><p>An estimate of the amount of time spent in <code class="code">report</code> itself when it was
called from <code class="code">main</code>.
</p>
</dd>
<dt><code class="code">children</code></dt>
<dd><p>An estimate of the amount of time spent in subroutines of <code class="code">report</code>
when <code class="code">report</code> was called from <code class="code">main</code>.
</p>
<p>The sum of the <code class="code">self</code> and <code class="code">children</code> fields is an estimate
of the amount of time spent within calls to <code class="code">report</code> from <code class="code">main</code>.
</p>
</dd>
<dt><code class="code">called</code></dt>
<dd><p>Two numbers: the number of times <code class="code">report</code> was called from <code class="code">main</code>,
followed by the total number of non-recursive calls to <code class="code">report</code> from
all its callers.
</p>
</dd>
<dt><code class="code">name and index number</code></dt>
<dd><p>The name of the caller of <code class="code">report</code> to which this line applies,
followed by the caller&rsquo;s index number.
</p>
<p>Not all functions have entries in the call graph; some
options to <code class="code">gprof</code> request the omission of certain functions.
When a caller has no entry of its own, it still has caller-lines
in the entries of the functions it calls.
</p>
<p>If the caller is part of a recursion cycle, the cycle number is
printed between the name and the index number.
</p></dd>
</dl>

<p>If the identity of the callers of a function cannot be determined, a
dummy caller-line is printed which has &lsquo;<samp class="samp">&lt;spontaneous&gt;</samp>&rsquo; as the
&ldquo;caller&rsquo;s name&rdquo; and all other fields blank.  This can happen for
signal handlers.
</p>
<hr>
</div>
<div class="subsection-level-extent" id="Subroutines">
<div class="nav-panel">
<p>
Next: <a href="#Cycles" accesskey="n" rel="next">How Mutually Recursive Functions Are Described</a>, Previous: <a href="#Callers" accesskey="p" rel="prev">Lines for a Function&rsquo;s Callers</a>, Up: <a href="#Call-Graph" accesskey="u" rel="up">The Call Graph</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h4 class="subsection" id="Lines-for-a-Function_0027s-Subroutines"><span>5.2.3 Lines for a Function&rsquo;s Subroutines<a class="copiable-link" href="#Lines-for-a-Function_0027s-Subroutines"> &para;</a></span></h4>

<p>A function&rsquo;s entry has a line for each of its subroutines&mdash;in other
words, a line for each other function that it called.  These lines&rsquo;
fields correspond to the fields of the primary line, but their meanings
are different because of the difference in context.
</p>
<p>For reference, we repeat two lines from the entry for the function
<code class="code">main</code>, the primary line and a line for a subroutine, together
with the heading line that shows the names of the fields:
</p>
<div class="example smallexample">
<pre class="example-preformatted">index  % time    self  children called     name
...
[2]    100.0    0.00    0.05       1         main [2]
                0.00    0.05       1/1           report [3]
</pre></div>

<p>Here are the meanings of the fields in the subroutine-line for <code class="code">main</code>
calling <code class="code">report</code>:
</p>
<dl class="table">
<dt><code class="code">self</code></dt>
<dd><p>An estimate of the amount of time spent directly within <code class="code">report</code>
when <code class="code">report</code> was called from <code class="code">main</code>.
</p>
</dd>
<dt><code class="code">children</code></dt>
<dd><p>An estimate of the amount of time spent in subroutines of <code class="code">report</code>
when <code class="code">report</code> was called from <code class="code">main</code>.
</p>
<p>The sum of the <code class="code">self</code> and <code class="code">children</code> fields is an estimate
of the total time spent in calls to <code class="code">report</code> from <code class="code">main</code>.
</p>
</dd>
<dt><code class="code">called</code></dt>
<dd><p>Two numbers, the number of calls to <code class="code">report</code> from <code class="code">main</code>
followed by the total number of non-recursive calls to <code class="code">report</code>.
This ratio is used to determine how much of <code class="code">report</code>&rsquo;s <code class="code">self</code>
and <code class="code">children</code> time gets credited to <code class="code">main</code>.
See <a class="xref" href="#Assumptions">Estimating <code class="code">children</code> Times</a>.
</p>
</dd>
<dt><code class="code">name</code></dt>
<dd><p>The name of the subroutine of <code class="code">main</code> to which this line applies,
followed by the subroutine&rsquo;s index number.
</p>
<p>If the caller is part of a recursion cycle, the cycle number is
printed between the name and the index number.
</p></dd>
</dl>

<hr>
</div>
<div class="subsection-level-extent" id="Cycles">
<div class="nav-panel">
<p>
Previous: <a href="#Subroutines" accesskey="p" rel="prev">Lines for a Function&rsquo;s Subroutines</a>, Up: <a href="#Call-Graph" accesskey="u" rel="up">The Call Graph</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h4 class="subsection" id="How-Mutually-Recursive-Functions-Are-Described"><span>5.2.4 How Mutually Recursive Functions Are Described<a class="copiable-link" href="#How-Mutually-Recursive-Functions-Are-Described"> &para;</a></span></h4>
<a class="index-entry-id" id="index-cycle"></a>
<a class="index-entry-id" id="index-recursion-cycle"></a>

<p>The graph may be complicated by the presence of <em class="dfn">cycles of
recursion</em> in the call graph.  A cycle exists if a function calls
another function that (directly or indirectly) calls (or appears to
call) the original function.  For example: if <code class="code">a</code> calls <code class="code">b</code>,
and <code class="code">b</code> calls <code class="code">a</code>, then <code class="code">a</code> and <code class="code">b</code> form a cycle.
</p>
<p>Whenever there are call paths both ways between a pair of functions, they
belong to the same cycle.  If <code class="code">a</code> and <code class="code">b</code> call each other and
<code class="code">b</code> and <code class="code">c</code> call each other, all three make one cycle.  Note that
even if <code class="code">b</code> only calls <code class="code">a</code> if it was not called from <code class="code">a</code>,
<code class="code">gprof</code> cannot determine this, so <code class="code">a</code> and <code class="code">b</code> are still
considered a cycle.
</p>
<p>The cycles are numbered with consecutive integers.  When a function
belongs to a cycle, each time the function name appears in the call graph
it is followed by &lsquo;<samp class="samp">&lt;cycle <var class="var">number</var>&gt;</samp>&rsquo;.
</p>
<p>The reason cycles matter is that they make the time values in the call
graph paradoxical.  The &ldquo;time spent in children&rdquo; of <code class="code">a</code> should
include the time spent in its subroutine <code class="code">b</code> and in <code class="code">b</code>&rsquo;s
subroutines&mdash;but one of <code class="code">b</code>&rsquo;s subroutines is <code class="code">a</code>!  How much of
<code class="code">a</code>&rsquo;s time should be included in the children of <code class="code">a</code>, when
<code class="code">a</code> is indirectly recursive?
</p>
<p>The way <code class="code">gprof</code> resolves this paradox is by creating a single entry
for the cycle as a whole.  The primary line of this entry describes the
total time spent directly in the functions of the cycle.  The
&ldquo;subroutines&rdquo; of the cycle are the individual functions of the cycle, and
all other functions that were called directly by them.  The &ldquo;callers&rdquo; of
the cycle are the functions, outside the cycle, that called functions in
the cycle.
</p>
<p>Here is an example portion of a call graph which shows a cycle containing
functions <code class="code">a</code> and <code class="code">b</code>.  The cycle was entered by a call to
<code class="code">a</code> from <code class="code">main</code>; both <code class="code">a</code> and <code class="code">b</code> called <code class="code">c</code>.
</p>
<div class="example smallexample">
<pre class="example-preformatted">index  % time    self  children called     name
----------------------------------------
                 1.77        0    1/1        main [2]
[3]     91.71    1.77        0    1+5    &lt;cycle 1 as a whole&gt; [3]
                 1.02        0    3          b &lt;cycle 1&gt; [4]
                 0.75        0    2          a &lt;cycle 1&gt; [5]
----------------------------------------
                                  3          a &lt;cycle 1&gt; [5]
[4]     52.85    1.02        0    0      b &lt;cycle 1&gt; [4]
                                  2          a &lt;cycle 1&gt; [5]
                    0        0    3/6        c [6]
----------------------------------------
                 1.77        0    1/1        main [2]
                                  2          b &lt;cycle 1&gt; [4]
[5]     38.86    0.75        0    1      a &lt;cycle 1&gt; [5]
                                  3          b &lt;cycle 1&gt; [4]
                    0        0    3/6        c [6]
----------------------------------------
</pre></div>

<p>(The entire call graph for this program contains in addition an entry for
<code class="code">main</code>, which calls <code class="code">a</code>, and an entry for <code class="code">c</code>, with callers
<code class="code">a</code> and <code class="code">b</code>.)
</p>
<div class="example smallexample">
<pre class="example-preformatted">index  % time    self  children called     name
                                             &lt;spontaneous&gt;
[1]    100.00       0     1.93    0      start [1]
                 0.16     1.77    1/1        main [2]
----------------------------------------
                 0.16     1.77    1/1        start [1]
[2]    100.00    0.16     1.77    1      main [2]
                 1.77        0    1/1        a &lt;cycle 1&gt; [5]
----------------------------------------
                 1.77        0    1/1        main [2]
[3]     91.71    1.77        0    1+5    &lt;cycle 1 as a whole&gt; [3]
                 1.02        0    3          b &lt;cycle 1&gt; [4]
                 0.75        0    2          a &lt;cycle 1&gt; [5]
                    0        0    6/6        c [6]
----------------------------------------
                                  3          a &lt;cycle 1&gt; [5]
[4]     52.85    1.02        0    0      b &lt;cycle 1&gt; [4]
                                  2          a &lt;cycle 1&gt; [5]
                    0        0    3/6        c [6]
----------------------------------------
                 1.77        0    1/1        main [2]
                                  2          b &lt;cycle 1&gt; [4]
[5]     38.86    0.75        0    1      a &lt;cycle 1&gt; [5]
                                  3          b &lt;cycle 1&gt; [4]
                    0        0    3/6        c [6]
----------------------------------------
                    0        0    3/6        b &lt;cycle 1&gt; [4]
                    0        0    3/6        a &lt;cycle 1&gt; [5]
[6]      0.00       0        0    6      c [6]
----------------------------------------
</pre></div>

<p>The <code class="code">self</code> field of the cycle&rsquo;s primary line is the total time
spent in all the functions of the cycle.  It equals the sum of the
<code class="code">self</code> fields for the individual functions in the cycle, found
in the entry in the subroutine lines for these functions.
</p>
<p>The <code class="code">children</code> fields of the cycle&rsquo;s primary line and subroutine lines
count only subroutines outside the cycle.  Even though <code class="code">a</code> calls
<code class="code">b</code>, the time spent in those calls to <code class="code">b</code> is not counted in
<code class="code">a</code>&rsquo;s <code class="code">children</code> time.  Thus, we do not encounter the problem of
what to do when the time in those calls to <code class="code">b</code> includes indirect
recursive calls back to <code class="code">a</code>.
</p>
<p>The <code class="code">children</code> field of a caller-line in the cycle&rsquo;s entry estimates
the amount of time spent <em class="emph">in the whole cycle</em>, and its other
subroutines, on the times when that caller called a function in the cycle.
</p>
<p>The <code class="code">called</code> field in the primary line for the cycle has two numbers:
first, the number of times functions in the cycle were called by functions
outside the cycle; second, the number of times they were called by
functions in the cycle (including times when a function in the cycle calls
itself).  This is a generalization of the usual split into non-recursive and
recursive calls.
</p>
<p>The <code class="code">called</code> field of a subroutine-line for a cycle member in the
cycle&rsquo;s entry says how many time that function was called from functions in
the cycle.  The total of all these is the second number in the primary line&rsquo;s
<code class="code">called</code> field.
</p>
<p>In the individual entry for a function in a cycle, the other functions in
the same cycle can appear as subroutines and as callers.  These lines show
how many times each function in the cycle called or was called from each other
function in the cycle.  The <code class="code">self</code> and <code class="code">children</code> fields in these
lines are blank because of the difficulty of defining meanings for them
when recursion is going on.
</p>
<hr>
</div>
</div>
<div class="section-level-extent" id="Line_002dby_002dline">
<div class="nav-panel">
<p>
Next: <a href="#Annotated-Source" accesskey="n" rel="next">The Annotated Source Listing</a>, Previous: <a href="#Call-Graph" accesskey="p" rel="prev">The Call Graph</a>, Up: <a href="#Output" accesskey="u" rel="up">Interpreting <code class="code">gprof</code>&rsquo;s Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Line_002dby_002dline-Profiling"><span>5.3 Line-by-line Profiling<a class="copiable-link" href="#Line_002dby_002dline-Profiling"> &para;</a></span></h3>

<p><code class="code">gprof</code>&rsquo;s &lsquo;<samp class="samp">-l</samp>&rsquo; option causes the program to perform
<em class="dfn">line-by-line</em> profiling.  In this mode, histogram
samples are assigned not to functions, but to individual
lines of source code.  This only works with programs compiled with
older versions of the <code class="code">gcc</code> compiler.  Newer versions of <code class="code">gcc</code>
use a different program - <code class="code">gcov</code> - to display line-by-line
profiling information.
</p>
<p>With the older versions of <code class="code">gcc</code> the program usually has to be
compiled with a &lsquo;<samp class="samp">-g</samp>&rsquo; option, in addition to &lsquo;<samp class="samp">-pg</samp>&rsquo;, in order
to generate debugging symbols for tracking source code lines.
Note, in much older versions of <code class="code">gcc</code> the program had to be
compiled with the &lsquo;<samp class="samp">-a</samp>&rsquo; command-line option as well.
</p>
<p>The flat profile is the most useful output table
in line-by-line mode.
The call graph isn&rsquo;t as useful as normal, since
the current version of <code class="code">gprof</code> does not propagate
call graph arcs from source code lines to the enclosing function.
The call graph does, however, show each line of code
that called each function, along with a count.
</p>
<p>Here is a section of <code class="code">gprof</code>&rsquo;s output, without line-by-line profiling.
Note that <code class="code">ct_init</code> accounted for four histogram hits, and
13327 calls to <code class="code">init_block</code>.
</p>
<div class="example smallexample">
<pre class="example-preformatted">Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  us/call  us/call  name
 30.77      0.13     0.04     6335     6.31     6.31  ct_init


		     Call graph (explanation follows)


granularity: each sample hit covers 4 byte(s) for 7.69% of 0.13 seconds

index % time    self  children    called     name

                0.00    0.00       1/13496       name_too_long
                0.00    0.00      40/13496       deflate
                0.00    0.00     128/13496       deflate_fast
                0.00    0.00   13327/13496       ct_init
[7]      0.0    0.00    0.00   13496         init_block

</pre></div>

<p>Now let&rsquo;s look at some of <code class="code">gprof</code>&rsquo;s output from the same program run,
this time with line-by-line profiling enabled.  Note that <code class="code">ct_init</code>&rsquo;s
four histogram hits are broken down into four lines of source code&mdash;one hit
occurred on each of lines 349, 351, 382 and 385.  In the call graph,
note how
<code class="code">ct_init</code>&rsquo;s 13327 calls to <code class="code">init_block</code> are broken down
into one call from line 396, 3071 calls from line 384, 3730 calls
from line 385, and 6525 calls from 387.
</p>
<div class="example smallexample">
<pre class="example-preformatted">Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self
 time   seconds   seconds    calls  name
  7.69      0.10     0.01           ct_init (trees.c:349)
  7.69      0.11     0.01           ct_init (trees.c:351)
  7.69      0.12     0.01           ct_init (trees.c:382)
  7.69      0.13     0.01           ct_init (trees.c:385)


		     Call graph (explanation follows)


granularity: each sample hit covers 4 byte(s) for 7.69% of 0.13 seconds

  % time    self  children    called     name

            0.00    0.00       1/13496       name_too_long (gzip.c:1440)
            0.00    0.00       1/13496       deflate (deflate.c:763)
            0.00    0.00       1/13496       ct_init (trees.c:396)
            0.00    0.00       2/13496       deflate (deflate.c:727)
            0.00    0.00       4/13496       deflate (deflate.c:686)
            0.00    0.00       5/13496       deflate (deflate.c:675)
            0.00    0.00      12/13496       deflate (deflate.c:679)
            0.00    0.00      16/13496       deflate (deflate.c:730)
            0.00    0.00     128/13496       deflate_fast (deflate.c:654)
            0.00    0.00    3071/13496       ct_init (trees.c:384)
            0.00    0.00    3730/13496       ct_init (trees.c:385)
            0.00    0.00    6525/13496       ct_init (trees.c:387)
[6]  0.0    0.00    0.00   13496         init_block (trees.c:408)

</pre></div>


<hr>
</div>
<div class="section-level-extent" id="Annotated-Source">
<div class="nav-panel">
<p>
Previous: <a href="#Line_002dby_002dline" accesskey="p" rel="prev">Line-by-line Profiling</a>, Up: <a href="#Output" accesskey="u" rel="up">Interpreting <code class="code">gprof</code>&rsquo;s Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="The-Annotated-Source-Listing"><span>5.4 The Annotated Source Listing<a class="copiable-link" href="#The-Annotated-Source-Listing"> &para;</a></span></h3>

<p><code class="code">gprof</code>&rsquo;s &lsquo;<samp class="samp">-A</samp>&rsquo; option triggers an annotated source listing,
which lists the program&rsquo;s source code, each function labeled with the
number of times it was called.  You may also need to specify the
&lsquo;<samp class="samp">-I</samp>&rsquo; option, if <code class="code">gprof</code> can&rsquo;t find the source code files.
</p>
<p>With older versions of <code class="code">gcc</code> compiling with &lsquo;<samp class="samp">gcc &hellip; -g
-pg -a</samp>&rsquo; augments your program with basic-block counting code, in
addition to function counting code.  This enables <code class="code">gprof</code> to
determine how many times each line of code was executed.  With newer
versions of <code class="code">gcc</code> support for displaying basic-block counts is
provided by the <code class="code">gcov</code> program.
</p>
<p>For example, consider the following function, taken from gzip,
with line numbers added:
</p>
<div class="example smallexample">
<pre class="example-preformatted"> 1 ulg updcrc(s, n)
 2     uch *s;
 3     unsigned n;
 4 {
 5     register ulg c;
 6
 7     static ulg crc = (ulg)0xffffffffL;
 8
 9     if (s == NULL) {
10         c = 0xffffffffL;
11     } else {
12         c = crc;
13         if (n) do {
14             c = crc_32_tab[...];
15         } while (--n);
16     }
17     crc = c;
18     return c ^ 0xffffffffL;
19 }

</pre></div>

<p><code class="code">updcrc</code> has at least five basic-blocks.
One is the function itself.  The
<code class="code">if</code> statement on line 9 generates two more basic-blocks, one
for each branch of the <code class="code">if</code>.  A fourth basic-block results from
the <code class="code">if</code> on line 13, and the contents of the <code class="code">do</code> loop form
the fifth basic-block.  The compiler may also generate additional
basic-blocks to handle various special cases.
</p>
<p>A program augmented for basic-block counting can be analyzed with
&lsquo;<samp class="samp">gprof -l -A</samp>&rsquo;.
The &lsquo;<samp class="samp">-x</samp>&rsquo; option is also helpful,
to ensure that each line of code is labeled at least once.
Here is <code class="code">updcrc</code>&rsquo;s
annotated source listing for a sample <code class="code">gzip</code> run:
</p>
<div class="example smallexample">
<pre class="example-preformatted">                ulg updcrc(s, n)
                    uch *s;
                    unsigned n;
            2 -&gt;{
                    register ulg c;

                    static ulg crc = (ulg)0xffffffffL;

            2 -&gt;    if (s == NULL) {
            1 -&gt;        c = 0xffffffffL;
            1 -&gt;    } else {
            1 -&gt;        c = crc;
            1 -&gt;        if (n) do {
        26312 -&gt;            c = crc_32_tab[...];
26312,1,26311 -&gt;        } while (--n);
                    }
            2 -&gt;    crc = c;
            2 -&gt;    return c ^ 0xffffffffL;
            2 -&gt;}
</pre></div>

<p>In this example, the function was called twice, passing once through
each branch of the <code class="code">if</code> statement.  The body of the <code class="code">do</code>
loop was executed a total of 26312 times.  Note how the <code class="code">while</code>
statement is annotated.  It began execution 26312 times, once for
each iteration through the loop.  One of those times (the last time)
it exited, while it branched back to the beginning of the loop 26311 times.
</p>
<hr>
</div>
</div>
<div class="chapter-level-extent" id="Inaccuracy">
<div class="nav-panel">
<p>
Next: <a href="#How-do-I_003f" accesskey="n" rel="next">Answers to Common Questions</a>, Previous: <a href="#Output" accesskey="p" rel="prev">Interpreting <code class="code">gprof</code>&rsquo;s Output</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Inaccuracy-of-gprof-Output"><span>6 Inaccuracy of <code class="code">gprof</code> Output<a class="copiable-link" href="#Inaccuracy-of-gprof-Output"> &para;</a></span></h2>


<ul class="mini-toc">
<li><a href="#Sampling-Error" accesskey="1">Statistical Sampling Error</a></li>
<li><a href="#Assumptions" accesskey="2">Estimating <code class="code">children</code> Times</a></li>
</ul>
<hr>
<div class="section-level-extent" id="Sampling-Error">
<div class="nav-panel">
<p>
Next: <a href="#Assumptions" accesskey="n" rel="next">Estimating <code class="code">children</code> Times</a>, Up: <a href="#Inaccuracy" accesskey="u" rel="up">Inaccuracy of <code class="code">gprof</code> Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Statistical-Sampling-Error"><span>6.1 Statistical Sampling Error<a class="copiable-link" href="#Statistical-Sampling-Error"> &para;</a></span></h3>

<p>The run-time figures that <code class="code">gprof</code> gives you are based on a sampling
process, so they are subject to statistical inaccuracy.  If a function runs
only a small amount of time, so that on the average the sampling process
ought to catch that function in the act only once, there is a pretty good
chance it will actually find that function zero times, or twice.
</p>
<p>By contrast, the number-of-calls and basic-block figures are derived
by counting, not sampling.  They are completely accurate and will not
vary from run to run if your program is deterministic and single
threaded.  In multi-threaded applications, or single threaded
applications that link with multi-threaded libraries, the counts are
only deterministic if the counting function is thread-safe.  (Note:
beware that the mcount counting function in glibc is <em class="emph">not</em>
thread-safe).  See <a class="xref" href="#Implementation">Implementation of Profiling</a>.
</p>
<p>The <em class="dfn">sampling period</em> that is printed at the beginning of the flat
profile says how often samples are taken.  The rule of thumb is that a
run-time figure is accurate if it is considerably bigger than the sampling
period.
</p>
<p>The actual amount of error can be predicted.
For <var class="var">n</var> samples, the <em class="emph">expected</em> error
is the square-root of <var class="var">n</var>.  For example,
if the sampling period is 0.01 seconds and <code class="code">foo</code>&rsquo;s run-time is 1 second,
<var class="var">n</var> is 100 samples (1 second/0.01 seconds), sqrt(<var class="var">n</var>) is 10 samples, so
the expected error in <code class="code">foo</code>&rsquo;s run-time is 0.1 seconds (10*0.01 seconds),
or ten percent of the observed value.
Again, if the sampling period is 0.01 seconds and <code class="code">bar</code>&rsquo;s run-time is
100 seconds, <var class="var">n</var> is 10000 samples, sqrt(<var class="var">n</var>) is 100 samples, so
the expected error in <code class="code">bar</code>&rsquo;s run-time is 1 second,
or one percent of the observed value.
It is likely to
vary this much <em class="emph">on the average</em> from one profiling run to the next.
(<em class="emph">Sometimes</em> it will vary more.)
</p>
<p>This does not mean that a small run-time figure is devoid of information.
If the program&rsquo;s <em class="emph">total</em> run-time is large, a small run-time for one
function does tell you that that function used an insignificant fraction of
the whole program&rsquo;s time.  Usually this means it is not worth optimizing.
</p>
<p>One way to get more accuracy is to give your program more (but similar)
input data so it will take longer.  Another way is to combine the data from
several runs, using the &lsquo;<samp class="samp">-s</samp>&rsquo; option of <code class="code">gprof</code>.  Here is how:
</p>
<ol class="enumerate">
<li> Run your program once.

</li><li> Issue the command &lsquo;<samp class="samp">mv gmon.out gmon.sum</samp>&rsquo;.

</li><li> Run your program again, the same as before.

</li><li> Merge the new data in <samp class="file">gmon.out</samp> into <samp class="file">gmon.sum</samp> with this command:

<div class="example">
<pre class="example-preformatted">gprof -s <var class="var">executable-file</var> gmon.out gmon.sum
</pre></div>

</li><li> Repeat the last two steps as often as you wish.

</li><li> Analyze the cumulative data using this command:

<div class="example">
<pre class="example-preformatted">gprof <var class="var">executable-file</var> gmon.sum &gt; <var class="var">output-file</var>
</pre></div>
</li></ol>

<hr>
</div>
<div class="section-level-extent" id="Assumptions">
<div class="nav-panel">
<p>
Previous: <a href="#Sampling-Error" accesskey="p" rel="prev">Statistical Sampling Error</a>, Up: <a href="#Inaccuracy" accesskey="u" rel="up">Inaccuracy of <code class="code">gprof</code> Output</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Estimating-children-Times"><span>6.2 Estimating <code class="code">children</code> Times<a class="copiable-link" href="#Estimating-children-Times"> &para;</a></span></h3>

<p>Some of the figures in the call graph are estimates&mdash;for example, the
<code class="code">children</code> time values and all the time figures in caller and
subroutine lines.
</p>
<p>There is no direct information about these measurements in the profile
data itself.  Instead, <code class="code">gprof</code> estimates them by making an assumption
about your program that might or might not be true.
</p>
<p>The assumption made is that the average time spent in each call to any
function <code class="code">foo</code> is not correlated with who called <code class="code">foo</code>.  If
<code class="code">foo</code> used 5 seconds in all, and 2/5 of the calls to <code class="code">foo</code> came
from <code class="code">a</code>, then <code class="code">foo</code> contributes 2 seconds to <code class="code">a</code>&rsquo;s
<code class="code">children</code> time, by assumption.
</p>
<p>This assumption is usually true enough, but for some programs it is far
from true.  Suppose that <code class="code">foo</code> returns very quickly when its argument
is zero; suppose that <code class="code">a</code> always passes zero as an argument, while
other callers of <code class="code">foo</code> pass other arguments.  In this program, all the
time spent in <code class="code">foo</code> is in the calls from callers other than <code class="code">a</code>.
But <code class="code">gprof</code> has no way of knowing this; it will blindly and
incorrectly charge 2 seconds of time in <code class="code">foo</code> to the children of
<code class="code">a</code>.
</p>
<p>We hope some day to put more complete data into <samp class="file">gmon.out</samp>, so that
this assumption is no longer needed, if we can figure out how.  For the
novice, the estimated figures are usually more useful than misleading.
</p>
<hr>
</div>
</div>
<div class="chapter-level-extent" id="How-do-I_003f">
<div class="nav-panel">
<p>
Next: <a href="#Incompatibilities" accesskey="n" rel="next">Incompatibilities with Unix <code class="code">gprof</code></a>, Previous: <a href="#Inaccuracy" accesskey="p" rel="prev">Inaccuracy of <code class="code">gprof</code> Output</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Answers-to-Common-Questions"><span>7 Answers to Common Questions<a class="copiable-link" href="#Answers-to-Common-Questions"> &para;</a></span></h2>

<dl class="table">
<dt>How can I get more exact information about hot spots in my program?</dt>
<dd>
<p>Looking at the per-line call counts only tells part of the story.
Because <code class="code">gprof</code> can only report call times and counts by function,
the best way to get finer-grained information on where the program
is spending its time is to re-factor large functions into sequences
of calls to smaller ones.  Beware however that this can introduce
artificial hot spots since compiling with &lsquo;<samp class="samp">-pg</samp>&rsquo; adds a significant
overhead to function calls.  An alternative solution is to use a
non-intrusive profiler, e.g. oprofile.
</p>
</dd>
<dt>How do I find which lines in my program were executed the most times?</dt>
<dd>
<p>Use the <code class="code">gcov</code> program.
</p>
</dd>
<dt>How do I find which lines in my program called a particular function?</dt>
<dd>
<p>Use &lsquo;<samp class="samp">gprof -l</samp>&rsquo; and lookup the function in the call graph.
The callers will be broken down by function and line number.
</p>
</dd>
<dt>How do I analyze a program that runs for less than a second?</dt>
<dd>
<p>Try using a shell script like this one:
</p>
<div class="example">
<pre class="example-preformatted">for i in `seq 1 100`; do
  fastprog
  mv gmon.out gmon.out.$i
done

gprof -s fastprog gmon.out.*

gprof fastprog gmon.sum
</pre></div>

<p>If your program is completely deterministic, all the call counts
will be simple multiples of 100 (i.e., a function called once in
each run will appear with a call count of 100).
</p>
</dd>
</dl>

<hr>
</div>
<div class="chapter-level-extent" id="Incompatibilities">
<div class="nav-panel">
<p>
Next: <a href="#Details" accesskey="n" rel="next">Details of Profiling</a>, Previous: <a href="#How-do-I_003f" accesskey="p" rel="prev">Answers to Common Questions</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Incompatibilities-with-Unix-gprof"><span>8 Incompatibilities with Unix <code class="code">gprof</code><a class="copiable-link" href="#Incompatibilities-with-Unix-gprof"> &para;</a></span></h2>

<p><small class="sc">GNU</small> <code class="code">gprof</code> and Berkeley Unix <code class="code">gprof</code> use the same data
file <samp class="file">gmon.out</samp>, and provide essentially the same information.  But
there are a few differences.
</p>
<ul class="itemize mark-bullet">
<li><small class="sc">GNU</small> <code class="code">gprof</code> uses a new, generalized file format with support
for basic-block execution counts and non-realtime histograms.  A magic
cookie and version number allows <code class="code">gprof</code> to easily identify
new style files.  Old BSD-style files can still be read.
See <a class="xref" href="#File-Format">Profiling Data File Format</a>.

</li><li>For a recursive function, Unix <code class="code">gprof</code> lists the function as a
parent and as a child, with a <code class="code">calls</code> field that lists the number
of recursive calls.  <small class="sc">GNU</small> <code class="code">gprof</code> omits these lines and puts
the number of recursive calls in the primary line.

</li><li>When a function is suppressed from the call graph with &lsquo;<samp class="samp">-e</samp>&rsquo;, <small class="sc">GNU</small>
<code class="code">gprof</code> still lists it as a subroutine of functions that call it.

</li><li><small class="sc">GNU</small> <code class="code">gprof</code> accepts the &lsquo;<samp class="samp">-k</samp>&rsquo; with its argument
in the form &lsquo;<samp class="samp">from/to</samp>&rsquo;, instead of &lsquo;<samp class="samp">from to</samp>&rsquo;.

</li><li>In the annotated source listing,
if there are multiple basic blocks on the same line,
<small class="sc">GNU</small> <code class="code">gprof</code> prints all of their counts, separated by commas.


</li><li>The blurbs, field widths, and output formats are different.  <small class="sc">GNU</small>
<code class="code">gprof</code> prints blurbs after the tables, so that you can see the
tables without skipping the blurbs.
</li></ul>

<hr>
</div>
<div class="chapter-level-extent" id="Details">
<div class="nav-panel">
<p>
Next: <a href="#GNU-Free-Documentation-License" accesskey="n" rel="next">GNU Free Documentation License</a>, Previous: <a href="#Incompatibilities" accesskey="p" rel="prev">Incompatibilities with Unix <code class="code">gprof</code></a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="chapter" id="Details-of-Profiling"><span>9 Details of Profiling<a class="copiable-link" href="#Details-of-Profiling"> &para;</a></span></h2>


<ul class="mini-toc">
<li><a href="#Implementation" accesskey="1">Implementation of Profiling</a></li>
<li><a href="#File-Format" accesskey="2">Profiling Data File Format</a></li>
<li><a href="#Internals" accesskey="3"><code class="code">gprof</code>&rsquo;s Internal Operation</a></li>
<li><a href="#Debugging" accesskey="4">Debugging <code class="code">gprof</code></a></li>
</ul>
<hr>
<div class="section-level-extent" id="Implementation">
<div class="nav-panel">
<p>
Next: <a href="#File-Format" accesskey="n" rel="next">Profiling Data File Format</a>, Up: <a href="#Details" accesskey="u" rel="up">Details of Profiling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Implementation-of-Profiling"><span>9.1 Implementation of Profiling<a class="copiable-link" href="#Implementation-of-Profiling"> &para;</a></span></h3>

<p>Profiling works by changing how every function in your program is compiled
so that when it is called, it will stash away some information about where
it was called from.  From this, the profiler can figure out what function
called it, and can count how many times it was called.  This change is made
by the compiler when your program is compiled with the &lsquo;<samp class="samp">-pg</samp>&rsquo; option,
which causes every function to call <code class="code">mcount</code>
(or <code class="code">_mcount</code>, or <code class="code">__mcount</code>, depending on the OS and compiler)
as one of its first operations.
</p>
<p>The <code class="code">mcount</code> routine, included in the profiling library,
is responsible for recording in an in-memory call graph table
both its parent routine (the child) and its parent&rsquo;s parent.  This is
typically done by examining the stack frame to find both
the address of the child, and the return address in the original parent.
Since this is a very machine-dependent operation, <code class="code">mcount</code>
itself is typically a short assembly-language stub routine
that extracts the required
information, and then calls <code class="code">__mcount_internal</code>
(a normal C function) with two arguments&mdash;<code class="code">frompc</code> and <code class="code">selfpc</code>.
<code class="code">__mcount_internal</code> is responsible for maintaining
the in-memory call graph, which records <code class="code">frompc</code>, <code class="code">selfpc</code>,
and the number of times each of these call arcs was traversed.
</p>
<p>GCC Version 2 provides a magical function (<code class="code">__builtin_return_address</code>),
which allows a generic <code class="code">mcount</code> function to extract the
required information from the stack frame.  However, on some
architectures, most notably the SPARC, using this builtin can be
very computationally expensive, and an assembly language version
of <code class="code">mcount</code> is used for performance reasons.
</p>
<p>Number-of-calls information for library routines is collected by using a
special version of the C library.  The programs in it are the same as in
the usual C library, but they were compiled with &lsquo;<samp class="samp">-pg</samp>&rsquo;.  If you
link your program with &lsquo;<samp class="samp">gcc &hellip; -pg</samp>&rsquo;, it automatically uses the
profiling version of the library.
</p>
<p>Profiling also involves watching your program as it runs, and keeping a
histogram of where the program counter happens to be every now and then.
Typically the program counter is looked at around 100 times per second of
run time, but the exact frequency may vary from system to system.
</p>
<p>This is done is one of two ways.  Most UNIX-like operating systems
provide a <code class="code">profil()</code> system call, which registers a memory
array with the kernel, along with a scale
factor that determines how the program&rsquo;s address space maps
into the array.
Typical scaling values cause every 2 to 8 bytes of address space
to map into a single array slot.
On every tick of the system clock
(assuming the profiled program is running), the value of the
program counter is examined and the corresponding slot in
the memory array is incremented.  Since this is done in the kernel,
which had to interrupt the process anyway to handle the clock
interrupt, very little additional system overhead is required.
</p>
<p>However, some operating systems, most notably Linux 2.0 (and earlier),
do not provide a <code class="code">profil()</code> system call.  On such a system,
arrangements are made for the kernel to periodically deliver
a signal to the process (typically via <code class="code">setitimer()</code>),
which then performs the same operation of examining the
program counter and incrementing a slot in the memory array.
Since this method requires a signal to be delivered to
user space every time a sample is taken, it uses considerably
more overhead than kernel-based profiling.  Also, due to the
added delay required to deliver the signal, this method is
less accurate as well.
</p>
<p>A special startup routine allocates memory for the histogram and
either calls <code class="code">profil()</code> or sets up
a clock signal handler.
This routine (<code class="code">monstartup</code>) can be invoked in several ways.
On Linux systems, a special profiling startup file <code class="code">gcrt0.o</code>,
which invokes <code class="code">monstartup</code> before <code class="code">main</code>,
is used instead of the default <code class="code">crt0.o</code>.
Use of this special startup file is one of the effects
of using &lsquo;<samp class="samp">gcc &hellip; -pg</samp>&rsquo; to link.
On SPARC systems, no special startup files are used.
Rather, the <code class="code">mcount</code> routine, when it is invoked for
the first time (typically when <code class="code">main</code> is called),
calls <code class="code">monstartup</code>.
</p>
<p>If the compiler&rsquo;s &lsquo;<samp class="samp">-a</samp>&rsquo; option was used, basic-block counting
is also enabled.  Each object file is then compiled with a static array
of counts, initially zero.
In the executable code, every time a new basic-block begins
(i.e., when an <code class="code">if</code> statement appears), an extra instruction
is inserted to increment the corresponding count in the array.
At compile time, a paired array was constructed that recorded
the starting address of each basic-block.  Taken together,
the two arrays record the starting address of every basic-block,
along with the number of times it was executed.
</p>
<p>The profiling library also includes a function (<code class="code">mcleanup</code>) which is
typically registered using <code class="code">atexit()</code> to be called as the
program exits, and is responsible for writing the file <samp class="file">gmon.out</samp>.
Profiling is turned off, various headers are output, and the histogram
is written, followed by the call-graph arcs and the basic-block counts.
</p>
<p>The output from <code class="code">gprof</code> gives no indication of parts of your program that
are limited by I/O or swapping bandwidth.  This is because samples of the
program counter are taken at fixed intervals of the program&rsquo;s run time.
Therefore, the
time measurements in <code class="code">gprof</code> output say nothing about time that your
program was not running.  For example, a part of the program that creates
so much data that it cannot all fit in physical memory at once may run very
slowly due to thrashing, but <code class="code">gprof</code> will say it uses little time.  On
the other hand, sampling by run time has the advantage that the amount of
load due to other users won&rsquo;t directly affect the output you get.
</p>
<hr>
</div>
<div class="section-level-extent" id="File-Format">
<div class="nav-panel">
<p>
Next: <a href="#Internals" accesskey="n" rel="next"><code class="code">gprof</code>&rsquo;s Internal Operation</a>, Previous: <a href="#Implementation" accesskey="p" rel="prev">Implementation of Profiling</a>, Up: <a href="#Details" accesskey="u" rel="up">Details of Profiling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Profiling-Data-File-Format"><span>9.2 Profiling Data File Format<a class="copiable-link" href="#Profiling-Data-File-Format"> &para;</a></span></h3>

<p>The old BSD-derived file format used for profile data does not contain a
magic cookie that allows one to check whether a data file really is a
<code class="code">gprof</code> file.  Furthermore, it does not provide a version number, thus
rendering changes to the file format almost impossible.  <small class="sc">GNU</small> <code class="code">gprof</code>
uses a new file format that provides these features.  For backward
compatibility, <small class="sc">GNU</small> <code class="code">gprof</code> continues to support the old BSD-derived
format, but not all features are supported with it.  For example,
basic-block execution counts cannot be accommodated by the old file
format.
</p>
<p>The new file format is defined in header file <samp class="file">gmon_out.h</samp>.  It
consists of a header containing the magic cookie and a version number,
as well as some spare bytes available for future extensions.  All data
in a profile data file is in the native format of the target for which
the profile was collected.  <small class="sc">GNU</small> <code class="code">gprof</code> adapts automatically
to the byte-order in use.
</p>
<p>In the new file format, the header is followed by a sequence of
records.  Currently, there are three different record types: histogram
records, call-graph arc records, and basic-block execution count
records.  Each file can contain any number of each record type.  When
reading a file, <small class="sc">GNU</small> <code class="code">gprof</code> will ensure records of the same type are
compatible with each other and compute the union of all records.  For
example, for basic-block execution counts, the union is simply the sum
of all execution counts for each basic-block.
</p>
<ul class="mini-toc">
<li><a href="#Histogram-Records" accesskey="1">Histogram Records</a></li>
<li><a href="#Call_002dGraph-Records" accesskey="2">Call-Graph Records</a></li>
<li><a href="#Basic_002dBlock-Execution-Count-Records" accesskey="3">Basic-Block Execution Count Records</a></li>
</ul>
<div class="subsection-level-extent" id="Histogram-Records">
<h4 class="subsection"><span>9.2.1 Histogram Records<a class="copiable-link" href="#Histogram-Records"> &para;</a></span></h4>

<p>Histogram records consist of a header that is followed by an array of
bins.  The header contains the text-segment range that the histogram
spans, the size of the histogram in bytes (unlike in the old BSD
format, this does not include the size of the header), the rate of the
profiling clock, and the physical dimension that the bin counts
represent after being scaled by the profiling clock rate.  The
physical dimension is specified in two parts: a long name of up to 15
characters and a single character abbreviation.  For example, a
histogram representing real-time would specify the long name as
&ldquo;seconds&rdquo; and the abbreviation as &ldquo;s&rdquo;.  This feature is useful for
architectures that support performance monitor hardware (which,
fortunately, is becoming increasingly common).  For example, under DEC
OSF/1, the &ldquo;uprofile&rdquo; command can be used to produce a histogram of,
say, instruction cache misses.  In this case, the dimension in the
histogram header could be set to &ldquo;i-cache misses&rdquo; and the abbreviation
could be set to &ldquo;1&rdquo; (because it is simply a count, not a physical
dimension).  Also, the profiling rate would have to be set to 1 in
this case.
</p>
<p>Histogram bins are 16-bit numbers and each bin represent an equal
amount of text-space.  For example, if the text-segment is one
thousand bytes long and if there are ten bins in the histogram, each
bin represents one hundred bytes.
</p>

</div>
<div class="subsection-level-extent" id="Call_002dGraph-Records">
<h4 class="subsection"><span>9.2.2 Call-Graph Records<a class="copiable-link" href="#Call_002dGraph-Records"> &para;</a></span></h4>

<p>Call-graph records have a format that is identical to the one used in
the BSD-derived file format.  It consists of an arc in the call graph
and a count indicating the number of times the arc was traversed
during program execution.  Arcs are specified by a pair of addresses:
the first must be within caller&rsquo;s function and the second must be
within the callee&rsquo;s function.  When performing profiling at the
function level, these addresses can point anywhere within the
respective function.  However, when profiling at the line-level, it is
better if the addresses are as close to the call-site/entry-point as
possible.  This will ensure that the line-level call-graph is able to
identify exactly which line of source code performed calls to a
function.
</p>
</div>
<div class="subsection-level-extent" id="Basic_002dBlock-Execution-Count-Records">
<h4 class="subsection"><span>9.2.3 Basic-Block Execution Count Records<a class="copiable-link" href="#Basic_002dBlock-Execution-Count-Records"> &para;</a></span></h4>

<p>Basic-block execution count records consist of a header followed by a
sequence of address/count pairs.  The header simply specifies the
length of the sequence.  In an address/count pair, the address
identifies a basic-block and the count specifies the number of times
that basic-block was executed.  Any address within the basic-address can
be used.
</p>
<hr>
</div>
</div>
<div class="section-level-extent" id="Internals">
<div class="nav-panel">
<p>
Next: <a href="#Debugging" accesskey="n" rel="next">Debugging <code class="code">gprof</code></a>, Previous: <a href="#File-Format" accesskey="p" rel="prev">Profiling Data File Format</a>, Up: <a href="#Details" accesskey="u" rel="up">Details of Profiling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="gprof_0027s-Internal-Operation"><span>9.3 <code class="code">gprof</code>&rsquo;s Internal Operation<a class="copiable-link" href="#gprof_0027s-Internal-Operation"> &para;</a></span></h3>

<p>Like most programs, <code class="code">gprof</code> begins by processing its options.
During this stage, it may building its symspec list
(<code class="code">sym_ids.c:sym_id_add</code>), if
options are specified which use symspecs.
<code class="code">gprof</code> maintains a single linked list of symspecs,
which will eventually get turned into 12 symbol tables,
organized into six include/exclude pairs&mdash;one
pair each for the flat profile (INCL_FLAT/EXCL_FLAT),
the call graph arcs (INCL_ARCS/EXCL_ARCS),
printing in the call graph (INCL_GRAPH/EXCL_GRAPH),
timing propagation in the call graph (INCL_TIME/EXCL_TIME),
the annotated source listing (INCL_ANNO/EXCL_ANNO),
and the execution count listing (INCL_EXEC/EXCL_EXEC).
</p>
<p>After option processing, <code class="code">gprof</code> finishes
building the symspec list by adding all the symspecs in
<code class="code">default_excluded_list</code> to the exclude lists
EXCL_TIME and EXCL_GRAPH, and if line-by-line profiling is specified,
EXCL_FLAT as well.
These default excludes are not added to EXCL_ANNO, EXCL_ARCS, and EXCL_EXEC.
</p>
<p>Next, the BFD library is called to open the object file,
verify that it is an object file,
and read its symbol table (<code class="code">core.c:core_init</code>),
using <code class="code">bfd_canonicalize_symtab</code> after mallocing
an appropriately sized array of symbols.  At this point,
function mappings are read (if the &lsquo;<samp class="samp">--file-ordering</samp>&rsquo; option
has been specified), and the core text space is read into
memory (if the &lsquo;<samp class="samp">-c</samp>&rsquo; option was given).
</p>
<p><code class="code">gprof</code>&rsquo;s own symbol table, an array of Sym structures,
is now built.
This is done in one of two ways, by one of two routines, depending
on whether line-by-line profiling (&lsquo;<samp class="samp">-l</samp>&rsquo; option) has been
enabled.
For normal profiling, the BFD canonical symbol table is scanned.
For line-by-line profiling, every
text space address is examined, and a new symbol table entry
gets created every time the line number changes.
In either case, two passes are made through the symbol
table&mdash;one to count the size of the symbol table required,
and the other to actually read the symbols.  In between the
two passes, a single array of type <code class="code">Sym</code> is created of
the appropriate length.
Finally, <code class="code">symtab.c:symtab_finalize</code>
is called to sort the symbol table and remove duplicate entries
(entries with the same memory address).
</p>
<p>The symbol table must be a contiguous array for two reasons.
First, the <code class="code">qsort</code> library function (which sorts an array)
will be used to sort the symbol table.
Also, the symbol lookup routine (<code class="code">symtab.c:sym_lookup</code>),
which finds symbols
based on memory address, uses a binary search algorithm
which requires the symbol table to be a sorted array.
Function symbols are indicated with an <code class="code">is_func</code> flag.
Line number symbols have no special flags set.
Additionally, a symbol can have an <code class="code">is_static</code> flag
to indicate that it is a local symbol.
</p>
<p>With the symbol table read, the symspecs can now be translated
into Syms (<code class="code">sym_ids.c:sym_id_parse</code>).  Remember that a single
symspec can match multiple symbols.
An array of symbol tables
(<code class="code">syms</code>) is created, each entry of which is a symbol table
of Syms to be included or excluded from a particular listing.
The master symbol table and the symspecs are examined by nested
loops, and every symbol that matches a symspec is inserted
into the appropriate syms table.  This is done twice, once to
count the size of each required symbol table, and again to build
the tables, which have been malloced between passes.
From now on, to determine whether a symbol is on an include
or exclude symspec list, <code class="code">gprof</code> simply uses its
standard symbol lookup routine on the appropriate table
in the <code class="code">syms</code> array.
</p>
<p>Now the profile data file(s) themselves are read
(<code class="code">gmon_io.c:gmon_out_read</code>),
first by checking for a new-style &lsquo;<samp class="samp">gmon.out</samp>&rsquo; header,
then assuming this is an old-style BSD &lsquo;<samp class="samp">gmon.out</samp>&rsquo;
if the magic number test failed.
</p>
<p>New-style histogram records are read by <code class="code">hist.c:hist_read_rec</code>.
For the first histogram record, allocate a memory array to hold
all the bins, and read them in.
When multiple profile data files (or files with multiple histogram
records) are read, the memory ranges of each pair of histogram records
must be either equal, or non-overlapping.  For each pair of histogram
records, the resolution (memory region size divided by the number of
bins) must be the same.  The time unit must be the same for all
histogram records. If the above containts are met, all histograms
for the same memory range are merged.
</p>
<p>As each call graph record is read (<code class="code">call_graph.c:cg_read_rec</code>),
the parent and child addresses
are matched to symbol table entries, and a call graph arc is
created by <code class="code">cg_arcs.c:arc_add</code>, unless the arc fails a symspec
check against INCL_ARCS/EXCL_ARCS.  As each arc is added,
a linked list is maintained of the parent&rsquo;s child arcs, and of the child&rsquo;s
parent arcs.
Both the child&rsquo;s call count and the arc&rsquo;s call count are
incremented by the record&rsquo;s call count.
</p>
<p>Basic-block records are read (<code class="code">basic_blocks.c:bb_read_rec</code>),
but only if line-by-line profiling has been selected.
Each basic-block address is matched to a corresponding line
symbol in the symbol table, and an entry made in the symbol&rsquo;s
bb_addr and bb_calls arrays.  Again, if multiple basic-block
records are present for the same address, the call counts
are cumulative.
</p>
<p>A gmon.sum file is dumped, if requested (<code class="code">gmon_io.c:gmon_out_write</code>).
</p>
<p>If histograms were present in the data files, assign them to symbols
(<code class="code">hist.c:hist_assign_samples</code>) by iterating over all the sample
bins and assigning them to symbols.  Since the symbol table
is sorted in order of ascending memory addresses, we can
simple follow along in the symbol table as we make our pass
over the sample bins.
This step includes a symspec check against INCL_FLAT/EXCL_FLAT.
Depending on the histogram
scale factor, a sample bin may span multiple symbols,
in which case a fraction of the sample count is allocated
to each symbol, proportional to the degree of overlap.
This effect is rare for normal profiling, but overlaps
are more common during line-by-line profiling, and can
cause each of two adjacent lines to be credited with half
a hit, for example.
</p>
<p>If call graph data is present, <code class="code">cg_arcs.c:cg_assemble</code> is called.
First, if &lsquo;<samp class="samp">-c</samp>&rsquo; was specified, a machine-dependent
routine (<code class="code">find_call</code>) scans through each symbol&rsquo;s machine code,
looking for subroutine call instructions, and adding them
to the call graph with a zero call count.
A topological sort is performed by depth-first numbering
all the symbols (<code class="code">cg_dfn.c:cg_dfn</code>), so that
children are always numbered less than their parents,
then making a array of pointers into the symbol table and sorting it into
numerical order, which is reverse topological
order (children appear before parents).
Cycles are also detected at this point, all members
of which are assigned the same topological number.
Two passes are now made through this sorted array of symbol pointers.
The first pass, from end to beginning (parents to children),
computes the fraction of child time to propagate to each parent
and a print flag.
The print flag reflects symspec handling of INCL_GRAPH/EXCL_GRAPH,
with a parent&rsquo;s include or exclude (print or no print) property
being propagated to its children, unless they themselves explicitly appear
in INCL_GRAPH or EXCL_GRAPH.
A second pass, from beginning to end (children to parents) actually
propagates the timings along the call graph, subject
to a check against INCL_TIME/EXCL_TIME.
With the print flag, fractions, and timings now stored in the symbol
structures, the topological sort array is now discarded, and a
new array of pointers is assembled, this time sorted by propagated time.
</p>
<p>Finally, print the various outputs the user requested, which is now fairly
straightforward.  The call graph (<code class="code">cg_print.c:cg_print</code>) and
flat profile (<code class="code">hist.c:hist_print</code>) are regurgitations of values
already computed.  The annotated source listing
(<code class="code">basic_blocks.c:print_annotated_source</code>) uses basic-block
information, if present, to label each line of code with call counts,
otherwise only the function call counts are presented.
</p>
<p>The function ordering code is marginally well documented
in the source code itself (<code class="code">cg_print.c</code>).  Basically,
the functions with the most use and the most parents are
placed first, followed by other functions with the most use,
followed by lower use functions, followed by unused functions
at the end.
</p>
<hr>
</div>
<div class="section-level-extent" id="Debugging">
<div class="nav-panel">
<p>
Previous: <a href="#Internals" accesskey="p" rel="prev"><code class="code">gprof</code>&rsquo;s Internal Operation</a>, Up: <a href="#Details" accesskey="u" rel="up">Details of Profiling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h3 class="section" id="Debugging-gprof"><span>9.4 Debugging <code class="code">gprof</code><a class="copiable-link" href="#Debugging-gprof"> &para;</a></span></h3>

<p>If <code class="code">gprof</code> was compiled with debugging enabled,
the &lsquo;<samp class="samp">-d</samp>&rsquo; option triggers debugging output
(to stdout) which can be helpful in understanding its operation.
The debugging number specified is interpreted as a sum of the following
options:
</p>
<dl class="table">
<dt>2 - Topological sort</dt>
<dd><p>Monitor depth-first numbering of symbols during call graph analysis
</p></dd>
<dt>4 - Cycles</dt>
<dd><p>Shows symbols as they are identified as cycle heads
</p></dd>
<dt>16 - Tallying</dt>
<dd><p>As the call graph arcs are read, show each arc and how
the total calls to each function are tallied
</p></dd>
<dt>32 - Call graph arc sorting</dt>
<dd><p>Details sorting individual parents/children within each call graph entry
</p></dd>
<dt>64 - Reading histogram and call graph records</dt>
<dd><p>Shows address ranges of histograms as they are read, and each
call graph arc
</p></dd>
<dt>128 - Symbol table</dt>
<dd><p>Reading, classifying, and sorting the symbol table from the object file.
For line-by-line profiling (&lsquo;<samp class="samp">-l</samp>&rsquo; option), also shows line numbers
being assigned to memory addresses.
</p></dd>
<dt>256 - Static call graph</dt>
<dd><p>Trace operation of &lsquo;<samp class="samp">-c</samp>&rsquo; option
</p></dd>
<dt>512 - Symbol table and arc table lookups</dt>
<dd><p>Detail operation of lookup routines
</p></dd>
<dt>1024 - Call graph propagation</dt>
<dd><p>Shows how function times are propagated along the call graph
</p></dd>
<dt>2048 - Basic-blocks</dt>
<dd><p>Shows basic-block records as they are read from profile data
(only meaningful with &lsquo;<samp class="samp">-l</samp>&rsquo; option)
</p></dd>
<dt>4096 - Symspecs</dt>
<dd><p>Shows symspec-to-symbol pattern matching operation
</p></dd>
<dt>8192 - Annotate source</dt>
<dd><p>Tracks operation of &lsquo;<samp class="samp">-A</samp>&rsquo; option
</p></dd>
</dl>

<hr>
</div>
</div>
<div class="appendix-level-extent" id="GNU-Free-Documentation-License">
<div class="nav-panel">
<p>
Previous: <a href="#Details" accesskey="p" rel="prev">Details of Profiling</a>, Up: <a href="#Top" accesskey="u" rel="up">Profiling a Program: Where Does It Spend Its Time?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<h2 class="appendix" id="GNU-Free-Documentation-License-1"><span>Appendix A GNU Free Documentation License<a class="copiable-link" href="#GNU-Free-Documentation-License-1"> &para;</a></span></h2>
<div class="center">Version 1.3, 3 November 2008
</div>

<div class="display">
<pre class="display-preformatted">Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
<a class="uref" href="http://fsf.org/">http://fsf.org/</a>

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></div>

<ol class="enumerate" start="0">
<li> PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em class="dfn">free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li> APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
<small class="sc">ASCII</small> without markup, Texinfo input format, LaTeX input
format, <abbr class="acronym">SGML</abbr> or <abbr class="acronym">XML</abbr> using a publicly available
<abbr class="acronym">DTD</abbr>, and standard-conforming simple <abbr class="acronym">HTML</abbr>,
PostScript or <abbr class="acronym">PDF</abbr> designed for human modification.  Examples
of transparent image formats include <abbr class="acronym">PNG</abbr>, <abbr class="acronym">XCF</abbr> and
<abbr class="acronym">JPG</abbr>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <abbr class="acronym">SGML</abbr> or
<abbr class="acronym">XML</abbr> for which the <abbr class="acronym">DTD</abbr> and/or processing tools are
not generally available, and the machine-generated <abbr class="acronym">HTML</abbr>,
PostScript or <abbr class="acronym">PDF</abbr> produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li> VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li> COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li> MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol class="enumerate" type="A" start="1">
<li> Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li> List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li> State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li> Preserve all the copyright notices of the Document.

</li><li> Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li> Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li> Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li> Include an unaltered copy of this License.

</li><li> Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li> Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li> For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li> Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li> Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li> Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li> Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li> COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li> COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li> AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li> TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li> TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.
</p>
<p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.
</p>
<p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.
</p>
<p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.
</p>
</li><li> FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a class="uref" href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy&rsquo;s public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.
</p>
</li><li> RELICENSING

<p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.
</p>
<p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.
</p>
<p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.
</p>
<p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.
</p>
</li></ol>

<h3 class="heading" id="ADDENDUM_003a-How-to-use-this-License-for-your-documents"><span>ADDENDUM: How to use this License for your documents<a class="copiable-link" href="#ADDENDUM_003a-How-to-use-this-License-for-your-documents"> &para;</a></span></h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">  Copyright (C)  <var class="var">year</var>  <var class="var">your name</var>.
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.3
  or any later version published by the Free Software Foundation;
  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
  Texts.  A copy of the license is included in the section entitled ``GNU
  Free Documentation License''.
</pre></div></div>

<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with&hellip;Texts.&rdquo; line with this:
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">    with the Invariant Sections being <var class="var">list their titles</var>, with
    the Front-Cover Texts being <var class="var">list</var>, and with the Back-Cover Texts
    being <var class="var">list</var>.
</pre></div></div>

<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.
</p>
<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.
</p>


</div>
</div>



</body>
</html>
